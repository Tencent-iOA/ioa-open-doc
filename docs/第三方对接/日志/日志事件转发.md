### 转发策略与命令字对应表

- 身份安全日志: 7725, 7221, 7222
- 终端安全日志: 7009, 7028, 7064, 7065, 7002, 7003, 7244
- 终端管控日志: 7108, 7272, 7245, 7501, 7021, 7732, 7509, 7102, 7033, 7066, 7036, 7038, 7103
- 安全准入日志: 9001
- License授权日志: 7257, 7268, 7252
- 终端合规日志: 7040, 7041, 7045, 7046, 7047, 7058, 7059, 7060, 7061, 7062, 7039
- EDR告警日志: 7510
- 软件统计日志: 7025, 7019
- 数据地图: 7784
- 企微数据安全审计: 7785
- 终端数据安全审计: 7780
- 管理员日志: 7210, 7211, 7212
- 终端运维日志: 7260, 7261
- 客户端操作日志: 7204, 7109, 7014, 7015, 7205, 7755, 7420, 7004, 7006, 7007
- 客户端修复日志: 7400
- 资源访问日志: 7233, 7234, 7720, 7370, 7371, 7053, 7055, 7249, 7250
- 风险分析日志: 7246
- 默认转发: 7520

### 公共字段

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| _type | string | 命令字 | |
| recvTime | string | 转发时间 | |
| sender | / | 上报源 | |
| sender.Type | string | 终端类型 | |
| sender.MID | string | 终端标识码 | |
| sender.PublicIP | string | 终端IP | |
| sender.ClientVersion | string | 终端版本 | |
| sender.Client |  | 终端信息 | |
| args | / | 其他上报信息 | |

### 终端信息公共字段

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Name | string | 终端名 | |
| User | string | 终端用户名 | |
| Account | string | 登录账号/企业账户 | |
| AccountName | string | 用户姓名 | |
| IpPort | string | 终端IP | |
| Mac | string | MAC地址 | |
| Mid | string | 终端标识码 | |
| GroupId | int | 终端分组ID | |
| GroupName | string | 终端分组 | |
| GroupIDPath | int[] | 终端分组ID路径 | |
| GroupNamePath | string[] | 终端分组路径 | |
| AccountGroupId | int | 用户分组ID | |
| AccountGroupName | string | 用户分组 | |
| AccountGroupIdPath | int[] | 用户分组ID路径 | |
| AccountGroupNamePath | string[] | 用户分组路径 | |
| OSType | string | 终端类型 | |

### 网络访问控制上报

对应日志报表：终端管控日志->终端网络访问控制日志

对应命令字：7066

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Category | string | 类型 | |
| Time | string | 日志采集时间 | |
| ProcessID | string | 访问URL的进程ID | |
| ProcessPath | string | 进程的完整路径 | |
| Protocol | string | 协议类型 | |
| Url | string | URL地址 | |
| IP | string | IP地址 | |

#### 示例

```json
{
    "Category": "UrlBlock",
    "Time": "2023-03-02 20:20:23",
    "ProcessID": "33656",
    "ProcessPath": "",
    "Protocol": "http",
    "Url": "http://www.example.com",
    "IP": "123.123.1.1"
}
```

### 终端访问日志上报

对应日志报表：资源访问日志->客户端访问日志->终端访问日志

对应命令字：7053

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| category | string | 类别 | ngnaccesslog: NGN代理日志<br /> |
| access_time | string | 请求时间 | |
| machine_name | string | 机器名 | |
| procname | string | 进程名 | |
| pid | string | 进程ID | |
| src_port | string | 浏览器源端口 | |
| agent_port | string | Agent端口 | |
| local_ip | string | 本机IP | |
| dest_ip | string | 远程目标IP（可能是网关，可能上网代理，也可能是直连目标） | |
| dest_port | string | 远程目标端口 | |
| request_method | string | 请求方法 | |
| request_url | string | 请求URL | |
| request_referer | string | 请求Referer | |
| user_agent | string | User-Agent | |
| traceid | string | TraceID | |
| current_user | string | 用户名 | |
| network | string | 网络协议类型（TCP, UDP 等） | |
| status_code | string | 网关返回的状态码 | |
| received_bytes | string | 接收字节数 | |
| sent_bytes | string | 上传字节数 | |
| lifetime | string | 连接持续时间，单位ms | |

#### 示例

```json
{
    "category": "ngnaccesslog",
    "access_time": "2023-02-14 23:58:32",
    "machine_name": "PC-1",
    "procname": "QQ",
    "pid": "549",
    "src_port": "37727",
    "agent_port": "12345",
    "local_ip": "172.16.30.231",
    "dest_ip": "91.189.91.157",
    "dest_port": "12345",
    "request_method": "GET",
    "request_url": "http://www.baidu.com",
    "request_referer": "http://www.baidu.com",
    "user_agent": "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_9_6 rv:3.0; hr-HR) AppleWebKit/534.16.3 (KHTML, like Gecko) Version/5.0 Safari/534.16.3",
    "traceid": "73190670-AEAB-4094-A455-9C79DDE09ADC",
    "current_user": "account1",
    "network": "TCP",
    "status_code": "200",
    "received_bytes": "123",
    "sent_bytes": "123",
    "lifetime": "123"
}
```

### 网关连接日志上报（SAAS）

对应日志报表：资源访问日志->代理访问日志

对应命令字：7232

支持版本：SAAS

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| channelId | string | 连接器id | |
| tenantId | string | 租户ID | |
| authorization | string | 认证信息 | |
| errinfo | string | 错误信息 | |
| datestamp | int | 日志时间 | |
| target | string | 目标地址 | |
| duration | int | TCP 连接持续的时间 | |
| remoteAddress | string | 客户端 IP 地址 | |
| remotePort | int | 客户端端口 | |
| remoteFamily | string | 客户端 IP 协议版本 | |
| localServerAddress | string | 智能网关 IP | |
| localServerPort | int | 智能网关端口 | |
| localFamily | string | 智能网关 IP 协议版本 | |
| targetHost | string | 目标域名或IP | |
| targetPort | int | 目标端口 | |
| forwardedFor | string | 代理协议鉴权信息 | |
| userAgent | string | Http 请求的 User-Agent | |

#### 示例

```json
{
    "channelId": "188106c3-8235-4fa9-b31f-e9a1162568e4",
    "tenantId": "1307451704",
    "authorization": "Basic eyJVc2VyTmFtZSI6IjEzNjkzNTk0Nzk2IiwiRGV2aWNlSUQiOiJCNkNBQjdDODRGMUU4MjE3NzJDQzhCOUZBNkQzQ0I2RjY0MDY4NzE0IiwiU1QiOiIyLk5UZzJOQUV4TXpZNU16VTVORGM1TmdFeE5qYzROREEzT1Rnd0FURTRNREEuQ2V1NGRJdjJFY2U5aW5KbXBQS29xMjBBcVFtQnFtWllqVUFSTzVmX3pwUS44Y2Q5NjM5ZGQ5YWMyMmI3MjcxNGQwNjkyN2YyMWVmMyIsIkFwcElEIjoiMCIsIkFwcE5hbWUiOiJTbWFydFZQTi5leGUiLCJBcHBWZXJzaW9uIjoiMjA4LjAuMjU0MS42MjAwMiIsIlJlcVVybCI6IjE3Mi4yMS4zMi45OjgwODAiLCJQcm9jTmFtZSI6ImlleHBsb3JlLmV4ZSIsIlNvdXJjZSI6IiIsIlBJRCI6MCwiU2VydmljZUlkIjoiMjM0IiwiVGVuYW50SWQiOiIxMzA0NDc5MTk2In0=",
    "errinfo": "",
    "datestamp": 1678408002876,
    "target": "172.21.32.9:8080",
    "duration": 15610,
    "remoteAddress": "172.16.61.8",
    "remotePort": 15850,
    "remoteFamily": "IPv4",
    "localServerAddress": "172.16.61.69",
    "localServerPort": 15850,
    "localFamily": "IPv4",
    "targetHost": "172.16.61.69",
    "targetPort": 443,
    "forwardedFor": "123.126.87.134",
    "userAgent": "mozilla/5.0"
}
```

### USB存储设备插拔上报

对应日志报表：终端管控日志->USB存储设备插拔日志

对应命令字：7038

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| category | string | 类型 | |
| Type | int | 插入或拔出 | 1: 插入，包括开机时就在的<br /> 2: 拔出<br /> |
| VID | string | VID | |
| PID | string | PID | |
| DeviceName | string | 设备名 | |
| PhysicSize | string | 硬盘容量（MB） | |
| DriverName | string | 盘符 | |
| VolumeName | string | 卷标名 | |

#### 示例

```json
{
    "category": "diskplug",
    "Type": 1,
    "VID": "1058",
    "PID": "25A2",
    "DeviceName": "kingston",
    "PhysicSize": "464727040",
    "DriverName": "I",
    "VolumeName": "TEST"
}
```

### 文件操作审计上报

对应日志报表：终端管控日志->文件管控日志->文件操作审计

对应命令字：7501

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| UtcTime | string | 本次策略监控结果生成的时间 | |
| acces_time | string | 访问时间 | |
| category | string | 上传类型 | |
| create_time | string | 创建时间 | |
| dst_filename | string | 目标文件路径 | |
| dst_vol_type | string | 目标设备类型 | 1: HARDISK<br /> 2: UDISK<br /> 3: CDROM<br /> 4: NETSHARE<br /> 5: HTTP<br /> 6: FTP<br /> |
| filesize | string | 文件大小 | |
| filetfinger | string | 源文件tfinger | |
| md5 | string | 源文件MD5 | |
| modify_time | string | 修改时间 | |
| operation | string | 文件操作类型 | 1: 创建<br /> 2: 复制<br /> 3: 移动<br /> 4: 删除<br /> 5: 重命名<br /> 6: 读取<br /> 7: 写入<br /> |
| process_id | string | 进程ID | |
| process_name | string | 进程名 | |
| process_path | string | 进程全路径 | |
| src_filename | string | 源文件路径 | |
| src_fileshortname | string | 源文件名 | |
| src_vol_type | string | 源设备类型 | 1: HARDISK<br /> 2: UDISK<br /> 3: CDROM<br /> 4: NETSHARE<br /> 5: HTTP<br /> 6: FTP<br /> |

#### 示例

```json
{
    "UtcTime": "2023-02-20 11:13:28",
    "acces_time": "2023-02-20 11:13:28",
    "category": "fileaudit",
    "create_time": "2021-01-12 15:54:07",
    "dst_filename": "/dest/file",
    "dst_vol_type": "2",
    "filesize": "150168",
    "filetfinger": "1034",
    "md5": "7F90F66F0B48F8ACBB9E486CC8CE02B9",
    "modify_time": "2023-02-20 11:12:45",
    "operation": "4",
    "process_id": "2516",
    "process_name": "Explorer.exe",
    "process_path": "C:\\windows\\Explorer.exe",
    "src_filename": "F:\\iOA_Enterprise_dev\\7.2\\client\\ftcommon\\Projects\\FTCommonBuild.sln",
    "src_fileshortname": "FTCommonBuild.sln",
    "src_vol_type": "2"
}
```

### 动态访问控制日志上报

对应日志报表：资源访问日志->客户端访问日志->动态访问控制日志

对应命令字：7720

支持版本：7.3+ (8.1+为7249)

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| access_time | string | 访问时间 | |
| apply_st_result | bool |  | True: 失败<br /> False: 成功<br /> |
| control_result | string | 访问状态 | proxy: 代理访问<br /> direct: 直连访问<br /> auth: 二次认证访问<br /> block: 拒绝访问<br /> direct: 直连访问<br /> unknown: 未知<br /> |
| dest_ip | string | 目标IP | |
| dest_port | int | 目标端口 | |
| dynamic_rule_name | string | 访问安全策略名称 | |
| info | string | 信息 | |
| intervals | string | 间隔 | |
| ioa_err_code | int | IOA错误码 | |
| local_st_state | int | 本地状态 | |
| machine_name | string | 机器名 | |
| net_err_code | int | 网络错误码 | |
| os_type | string | 操作系统类型 | |
| policy_id | string | 策略ID | |
| protocol | int | 协议 | |
| req_pid | string | 请求进程ID | |
| req_pname | string | 请求进程名 | |
| req_timestamp | string | 请求时间戳 | |
| server_action | string | 服务端返回的访问动作 | proxy: 代理访问<br /> direct: 直连访问<br /> auth: 二次认证访问<br /> unknown: 未知<br /> direct: 直连访问<br /> |
| source_ip | string | 源IP | |
| source_port | int | 源端口 | |
| traceid | string | 链路ID | |
| uid | string | UID | |
| upload_timestamp | string | 上传时间戳 | |
| upload_type | string | 上传类型 | |
| user_id | string | 登录用户 | |

#### 示例

```json
{
    "access_time": "2023-03-01 10:29:32",
    "apply_st_result": True,
    "control_result": "proxy",
    "dest_ip": "connc.gj.qq.com",
    "dest_port": 36688,
    "dynamic_rule_name": "合规限制访问*.nju.edu.cn",
    "info": "xxx",
    "intervals": "instant",
    "ioa_err_code": -1,
    "local_st_state": 3,
    "machine_name": "DESKTOP-PNM22EF",
    "net_err_code": 0,
    "os_type": "windows",
    "policy_id": "110",
    "protocol": 6,
    "req_pid": "1964",
    "req_pname": "QQPCRTP.exe",
    "req_timestamp": "1677637769",
    "server_action": "proxy",
    "source_ip": "192.168.255.10",
    "source_port": 62700,
    "traceid": "1e2c336f-a4eb-460a-a5d0-01c2c0ad3c7f",
    "uid": "2478",
    "upload_timestamp": "1677637772",
    "upload_type": "ngn_ctrol_flow",
    "user_id": "ChengDing"
}
```

### 客户端版本升级上报

对应日志报表：客户端操作日志->客户端升级日志

对应命令字：7004

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| DlSpeed | int | 下载速度 | |
| RuleID | int | 阶段，9999表示最后一步 | |
| FailReason | int | 失败原因 | |
| ProxyType | int | 使用代理类型 | |
| category | string | 类型 | |
| UpdateResult | int | 升级结果 | |
| ElapseTime | int | 升级时长 | |
| UpdateSource | int | 升级来源 | |
| UpdateMode | int | 升级方式 | 2: 任务升级<br /> 6: 手动升级<br /> 7: 策略升级<br /> 8: 策略首次自动升级<br /> |
| DstVersion | string | 目标版本 | |
| OldVersion | int | 原始版本 | |

#### 示例

```json
{
    "DlSpeed": 0,
    "RuleID": 9999,
    "FailReason": 0,
    "ProxyType": 0,
    "category": "updatedata",
    "UpdateResult": 2,
    "ElapseTime": 1,
    "UpdateSource": 1000,
    "UpdateMode": 2,
    "DstVersion": "101.102.2416.220",
    "OldVersion": 101.101.2413.203
}
```

### 卸载上报

对应日志报表：客户端操作日志->安装卸载启动退出日志

对应命令字：7007

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| duration | int | 以ms计的安装时长 | |
| ver | string | 本次卸载的版本 | |
| isSilent | int | 是否为静默卸载 | |
| category | string | 类型 | |
| parentProcess | string | 父进程名 | |

#### 示例

```json
{
    "duration": 6141,
    "ver": "107.5.14593.201",
    "isSilent": 1,
    "category": "iOA_Uninstall",
    "parentProcess": "0:PCMgrSetup_107_5_14642_201_cfg(ioa-2.woa.com@27800).exe;1:explorer.exe;"
}
```

### 退出上报

对应日志报表：客户端操作日志->安装卸载启动退出日志

对应命令字：7014

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Result | int | 错误码，0表示成功 | 0: Tray正常退出<br /> 1: Tray正常启动<br /> 2: Tray异常退出<br /> 3: RTP异常退出<br /> |

#### 示例

```json
{
    "Result": 0
}
```

### 终端安全管控授权日志上报

对应日志报表：License授权日志->终端安全管控授权日志

对应命令字：7243

支持版本：SAAS

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Operation | string | 授权操作 | 激活授权: <br /> 回收授权: <br /> |
| ActivationStatus | string | 激活状态 | 自动激活: <br /> 手动激活: <br /> 自动回收: <br /> 手动回收: <br /> |
| Timestamp | int | 上报时间戳 | |
| Duration | int | 占用时长（s) | |
| Mid | string | 设备ID | |
| DomainID | string | 组织域 ID | |
| UserID | string | 用户账号 | |

#### 示例

```json
{
    "Operation": "激活授权",
    "ActivationStatus": "自动激活",
    "Timestamp": 1654745421,
    "Duration": 100,
    "Mid": "89E2C7642432F54838D25C38D57314F25E2133FA",
    "DomainID": "8",
    "UserID": "用户账号"
}
```

### KB修复上报

对应日志报表：客户端修复->客户端修复日志

对应命令字：7400

支持版本：7.3+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| EngineVersion | string | 修复引擎的版本 | |
| Msg | string | 修复结果补充说明 | |
| PatchDesc | string | 补丁修复详情 | |
| PatchKB | string |  | |
| PatchPackageName | string | 修复的补丁包名 | |
| PatchPackageSize | string | 修复的补丁包大小（单位KB） | |
| PatchPackageVersion | string | 修复的补丁包版本 | |
| PatchPublishTime | string | 补丁包发布时间戳 | |
| PatchTitle | string | 补丁简短名称 | |
| Result | string | 修复结果 | expired: 过期<br /> unsupport: 不支持<br /> success: 成功<br /> fail: 失败<br /> effect: 生效<br /> |
| SessionID | string | 修复会话ID | |
| TimeCost | int | 修复总耗时 | |
| TimeStart | string | 修复开始时间 | |

#### 示例

```json
{
    "EngineVersion": "202210110000",
    "Msg": "",
    "PatchDesc": "修复蓝屏问题",
    "PatchKB": "KB00000002",
    "PatchPackageName": "patches_4",
    "PatchPackageSize": "5602",
    "PatchPackageVersion": "202209091031",
    "PatchPublishTime": "2022-09-13 11:24:00",
    "PatchTitle": "蓝屏问题修复",
    "Result": "effect",
    "SessionID": "{BEB505A9-4A27-4440-8054-CA031D5EFB19}",
    "TimeCost": 0,
    "TimeStart": "2023-02-27 16:54:21"
}
```

### 远程协助操作日志上报

对应日志报表：客户端操作日志->远程协助日志

对应命令字：7205

支持版本：7.3+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| ErrCode | int | 错误码 | |
| LogTime | int | 日志时间 | |
| ReportType | string | 上报类型 | 发起: <br /> 结束: <br /> |
| Result | string | 协助结果 | 远程链接建立成功: <br /> 目标终端拒绝: <br /> 无法通信: <br /> 成功: <br /> |
| TargetEndpointName | string |  | |
| TargetIP | string | 目标终端IP | |
| TargetMAC | string | 目标终端MAC | |
| TargetMID | string | 目标终端MID | |

#### 示例

```json
{
    "ErrCode": 0,
    "LogTime": 1677588596,
    "ReportType": "发起",
    "Result": "远程链接建立成功",
    "TargetEndpointName": "raymondrao-PC0",
    "TargetIP": "10.6.60.41",
    "TargetMAC": "70:5A:0F:42:6F:DE",
    "TargetMID": "89E2C7642432F54838D25C38D57314F25E2133FA"
}
```

### 病毒查杀上报

对应日志报表：终端安全日志->病毒查杀日志

对应命令字：7002

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Type | int | 上报类型 | 1: 发现时的上报，FixType 和 FixResult 无效<br /> 2: 处理时的上报<br /> |
| IsSysRep | int | 是否系统修复 | 0: 非系统上报<br /> 1: 系统上报<br /> |
| Name | string | 病毒名 | |
| Md5 | string | 病毒MD5 | |
| Path | string | 病毒文件在用户机器上的路径 | |
| Src | int | 来源，扫描 | |
| CallType | int | 调用方 | |
| FixType | int | 修复类型 | 1: 忽略<br /> 2: 修复<br /> 3: 信任<br /> |
| FixResult | int | 修复结果 | 0: 失败<br /> 1: 成功<br /> |
| VirusType | string | 病毒类型 | |
| TavLibVer | string | Tav合成版本号 | |
| SysrepVer | string | 系统修复引擎库版本 | |
| PhishLog | int | 是否上传钓鱼日志 | 1: 是钓鱼日志 支持版本:8.x |
| PhishRiskTitle | string | 钓鱼告警名称 | 支持版本:8.x |
| PhishDetectEngine | string | 钓鱼告警引擎 | 支持版本:8.x |
| PhishStage | string | 钓鱼告警阶段 | 支持版本:8.x |
| PhishSource | string | 钓鱼来源 | |
| PhishSourceProduct | string | 钓鱼产品 | 支持版本:8.x |
| PhishType | int | 钓鱼类型 | 支持版本:8.x |
| PhishFile | string | 钓鱼文件 | 支持版本:8.x |
| PhishFileMd5 | string | 钓鱼文件md5 | 支持版本:8.x |
| PhishFixResult | int | 钓鱼结果 | 支持版本:8.x |
| PhishUrl | string | 钓鱼外联IP | 支持版本:8.x |
| PhishIP | string | 钓鱼外联地址 | 支持版本:8.x |
| PhishChain | string | 钓鱼攻击链 | 支持版本:8.x |
| PhishDetails | string | 钓鱼详情 | 支持版本:8.x |


#### 示例

```json
{
    "Type": 2,
    "IsSysRep": 1,
    "Name": "Win32.trojan.test.111",
    "Md5": "B7A7C74D223399FC9F8BE27EB9DF30F1",
    "Path": "c:\\1.exe",
    "Src": 1,
    "CallType": 1,
    "FixType": 1,
    "FixResult": 1,
    "VirusType": "后门程序",
    "TavLibVer": "...",
    "SysrepVer": "...",
    "PhishLog":1,// 1开启 0 关闭
	"PhishRiskTitle":"",  //告警名称
	"PhishDetectEngine":1, //检测引擎 0 未知 1 云查引擎 2 TAV(包含yara引擎) 3 系统修复引擎 4 黑名单 5 社工防护引擎
	"PhishStage":4, //检出阶段 1 传输落地 2 执行加载 3 行为对抗 4  外联C2
	"PhishSource":"wechat.exe",	//钓鱼来源
	"PhishSourceProduct":"微信", //钓鱼来源产品名
	"PhishType": 1, //1 IM(即时通讯) 2 邮件 3 浏览器 4 下载工具 5 网盘 6 管理工具 7 其他渠道
	"PhishFile":"",		//文件路径
	"PhishFileMd5":"",	//文件md5
	"PhishFixResult":1, //处理结果 1 已删除文件 2 已阻断告警进程 3 已阻断进程行为 4 已拦截进程联网 5 未处置 6 处置失败 7 已允许
	"PhishUrl":"", //域名或i
	// 钓鱼溯源链 
	// type 1 文件 2 进程 3 注册表 4 网络 5 系统 6 横移
	// type1 action 1 下载 2 释放 3 修改 4 删除 5 覆盖 6 重命名 7 创建 8 HardLink 9 PendingRename 10 DllHjack 11 DenyWrite
	// type2 action 1 进程创建  2 注入 3 lnk执行 4 执行 5 OpenProcess 6 ReadProcessMemory 7 WriteProcessMemory 8 TeminateProcess 9 Hook 10 CreateProcess 11 ExitProcess 12 CreateRemoteThread 13 TerminateThread 14 SuspendThread 15 QueueApc 16 ThreadSetContext 17 ThreadCreate 18 ThreadExit 19 DumpLsass 20 DotnetLoad
	// type3 action 1 CreateKey 2 DeleteKey 3 ModifyKey 4 CreateValue 5 ModifyValue 6 DeleteValue 7 QueryValue
	// type4 action 1 外联C2 Connect
	// type5 action 1 ChangeService 2 DeleteService 3 ShowWindow 4 SetWindowPos 5 SetWindowLong 6 SimulateClick 7 DeviceIoControl 8 SystemReboot 9 WmiProc 10 MemScan
	// type6 action :1 本地服务创建, 2 本地服务启动, 3 本地服务修改, 4 本地删除服务  5 本地停止服务 6 高危com调用 
	"PhishChain":[{"type":1,"action":1, "src":"微信.exe", "target":"1.rar"},{"type":1, "action":1, "src":"1.rar", "target":"1.exe"}, {"type":4, "action":1, "src":"1.exe", "target":"IP/域名"}],
    //钓鱼详情
	"PhishDetails":{"OptProcId":"","OptProcPath":"","OptProcCmd":"","OptProcFileMd5":"","ChildProcId":"","ChileProcPath":"","ChildProcCmd":"","ChildProcFileMd5":"","Ip":"","Domain":"","TrojanName":"","ParentProcId":"","ParentProcPath":"","ParentProcCmd":"","ParentProcFileMd5":"","ThreadId":"","ThreadFilePath":"","ThreadFileMd5":"","FileMd5":"","FilePath":"","SubFilePath":"","SubFileMd5":"","TargetFileMd5":"","TargetFilePath":"","Md5":"","Target":"","Object":"","RegPath":"","RegValueData":"","RegValueName":"","RegValueType":"","Operation":"","ServiceName":"","ServiceType":""}
}
```

### NGN并发授权日志上报

对应日志报表：License授权日志->NGN并发授权日志

对应命令字：7242

支持版本：SAAS

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Operation | int | 授权操作 | 1: 激活授权<br /> 2: 更新活跃时间<br /> 3: 回收授权<br /> |
| Result | int | 执行结果 | 1: 成功<br /> 2: 失败<br /> |
| Os | int | 系统平台类型 | 0: win<br /> 1: linux<br /> 2: mac<br /> 4: android<br /> 5: ios<br /> 6: web<br /> |
| Timestamp | int | 上报时间戳 | |
| Mid | string | 设备ID | |
| GroupId | int | 用户分组ID | |
| UserId | string | 用户账号 | |
| Uid | int | 用户唯一ID | |
| TenantId | string | 租户 ID | |

#### 示例

```json
{
    "Operation": 1,
    "Result": 1,
    "Os": 0,
    "Timestamp": 1654745421,
    "Mid": "89E2C7642432F54838D25C38D57314F25E2133FA",
    "GroupId": 999,
    "UserId": "用户账号",
    "Uid": 999,
    "TenantId": ""
}
```

### 安装上报

对应日志报表：客户端操作日志->安装卸载启动退出日志

对应命令字：7006

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| duration | int | 以ms计的安装时长 | |
| isVM | int | 是否在VMware虚拟机内安装 | |
| lastInstallTime | int | 上次安装时间(UNIX时间戳) | |
| lastUninstallTime | int | 上次卸载时间(UNIX时间戳) | |
| packetMD5 | string | 安装数据包KPacket MD5 | |
| ver | string | 本次安装的版本 | |
| oldVer | string | 老版本 | |
| isSilent | int | 是否为静默安装 | |
| parentProcess | string | 父进程名 | |
| supply | string | 渠道名 | |
| subSupply | string | 子渠道名 | |

#### 示例

```json
{
    "duration": 50000,
    "isVM": 0,
    "lastInstallTime": 1505807610,
    "lastUninstallTime": 1505808155,
    "packetMD5": "",
    "ver": "107.4.5951.62001",
    "oldVer": "",
    "isSilent": 1,
    "parentProcess": "",
    "supply": "",
    "subSupply": ""
}
```

### 互联网拦截日志上报

对应日志报表：资源访问日志->互联网拦截日志

对应命令字：7250

支持版本：7.5+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| RequestUri | string | 请求的URI | |
| Result | int | 授权查询结果 | 1: 允许访问<br /> 2: 禁止访问<br /> |
| Response | string | 详细信息 | |
| DeviceId | string | 设备ID | |
| Os | string | 设备平台 | |
| ServiceId | string | 服务ID | |
| Timestamp | int | 时间戳 | |
| Uid | int | 用户UID | |
| UserId | string | 用户ID | |

#### 示例

```json
{
    "RequestUri": "download.api.bsb.baidu.com:443",
    "Result": 1,
    "Response": "允许访问",
    "DeviceId": "C8D8EE8BDA1E7000B635A398182F68EC63F5D39A02",
    "Os": "mac",
    "ServiceId": "132",
    "Timestamp": 1678088953,
    "Uid": 4679,
    "UserId": "k2"
}
```

### RDP二次认证结果上报

对应日志报表：终端管控日志——远程桌面二次认证日志

对应命令字：7732

支持版本：7.5+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| ClientIp | string | RDP远程Client的IP | |
| DomainName | string | 目标终端用户名所在的域 | |
| MenuId | string | 用户目录 | |
| RequestId | string | 请求ID | |
| Result | int | RDP二次认证的结果 | 0: 失败<br /> 1: 成功<br /> |
| TraceId | string | TraceID | |
| UserId | string | RDP二次认证输入的账号 | |
| UserName | string | RDP登录时使用的目标电脑用户名 | |

#### 示例

```json
{
    "ClientIp": "192.168.102.146",
    "DomainName": "ioaAD.com",
    "MenuId": "515",
    "RequestId": "a2a9e7f6-52da-47e6-bd70-24a294dc69c9",
    "Result": 1,
    "TraceId": "l-bc779e5a-b4a7-4248-93ca-e16bde1abdb3",
    "UserId": "wang4",
    "UserName": "win10-2020-vicky"
}
```

### 域账号本地弱密码检测上报

对应日志报表：终端合规日志->违规弱密码日志

对应命令字：7061

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| CurrentWeakPassword | string | 弱密码检测 | |
| ErrorCode | string | 扫描项检查失败的错误信息 | |
| Source | int | 来源 | 0: 未知<br /> 1: 界面触发<br /> 1: 定时器触发<br /> |
| Result | int | 合规检查结果 | 0: 未进行合规检查<br /> 1: 合规<br /> 2: 不合规<br /> 3: 检查失败<br /> |
| Risklevel | int | 风险等级 | |

#### 示例

```json
{
    "CurrentWeakPassword": "",
    "ErrorCode": "xxx api error",
    "Source": 1,
    "Result": 0,
    "Risklevel": -1
}
```

### 网络审计URL访问上报

对应日志报表：终端安全日志->信息采集日志->URL（IP）网络协议

对应命令字：7064

支持版本：7.3+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Category | string | 类型 | |
| IP | string | 目的IP | |
| ProcessID | string | 访问Url的进程ID | |
| ProcessPath | string | 进程的完整路径 | |
| Protocol | string | 协议类型：http or 其它tcp流 | |
| Url | string | Url | |
| UtcTime | string | 日志采集时间 | |

#### 示例

```json
{
    "Category": "UrlRecord",
    "IP": "10.28.70.100:443",
    "ProcessID": "6232",
    "ProcessPath": "C:\Program Files (x86)\iOA\iOABiz.exe",
    "Protocol": "Tcp",
    "Url": "10.28.70.100:443",
    "UtcTime": "2023-03-02 20:20:16"
}
```

### 端口违规上报

对应日志报表：终端合规日志->违规端口日志

对应命令字：7047

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| ViolationList | other | 不合规的端口列表 | |
| ErrorCode | string | 扫描项检查失败的错误信息 | |
| Source | int | 来源 | 0: 未知<br /> 1: 界面触发<br /> 1: 定时器触发<br /> |
| Result | int | 合规检查结果 | 0: 未进行合规检查<br /> 1: 合规<br /> 2: 不合规<br /> 3: 检查失败<br /> |
| Risklevel | int | 风险等级 | |

#### 示例

```json
{
    "ViolationList": [{'protocol': 'tcp', 'port': 139, 'pname': '进程名', 'cmdline': '命令行', 'state': 1}, {'protocol': 'udp', 'port': 137, 'pname': '进程名', 'cmdline': '命令行', 'state': 1}],
    "ErrorCode": "xxx api error",
    "Source": 1,
    "Result": 0,
    "Risklevel": -1
}
```

### 准入终端接入上报

对应日志报表：安全准入日志——准入日志

对应命令字：9001

支持版本：7.3+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| mac | string | 终端mac | |
| strNasIp | string | 接入交换机IP | |
| strNasPort | string | 接入交换机port | |
| strUserName | string | 用户名 | |
| nRepType | string | 认证类型 | |
| retcode | string | 认证错误码 | |
| ret | string | 结果 | |
| updatetime | string | 更新时间 | |
| reason | string | 错误原因 | |
| isvlan | string | vlan开关 | |
| vlanid | string | vlanID | |
| device_ip | string | 终端IP | |
| nettype | string | 网络类型 | |
| persontype | string | 用户类型 | |
| radiusip | string | radius服务IP，DM断网用 | |
| radiusport | string | radius端口，默认3799，DM断网用 | |
| svrname | string | 准入服务名称 | |
| svrid | string | 准入服务ID | |
| svrtype | string | 服务类型 | |

#### 示例

```json
{
    "mac": "00:0E:C6:A3:15:4A",
    "strNasIp": "192.168.3.10",
    "strNasPort": "5",
    "strUserName": "000ec6a3154a",
    "nRepType": "mab",
    "retcode": "0",
    "ret": "1",
    "updatetime": "1595658791",
    "reason": "MAB_WHITE_ACCEPT",
    "isvlan": "1",
    "vlanid": "-1",
    "device_ip": "192.168.3.54",
    "nettype": "",
    "persontype": "",
    "radiusip": "10.80.25.48",
    "radiusport": "28852",
    "svrname": "svr_inac",
    "svrid": "87d927fd5e7ae7ba1c805392513dfe31",
    "svrtype": "inac"
}
```

### 违规注册表检测上报

对应日志报表：终端合规日志->违规注册表日志

对应命令字：7062

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Source | int | 来源 | 0: 未知<br /> 1: 界面触发<br /> 1: 定时器触发<br /> |
| Result | int | 合规检查结果 | 0: 未进行合规检查<br /> 1: 合规<br /> 2: 不合规<br /> 3: 检查失败<br /> |
| ViolationList | other | 不合规的注册表键值 | |
| ErrorCode | string | 扫描项检查失败的错误信息 | |
| Risklevel | int | 风险等级 | |

#### 示例

```json
{
    "Source": 1,
    "Result": 0,
    "ViolationList": [{'type': 1, 'path': 'HMLS/XXX', 'key': 'xxx', 'value': '123'}],
    "ErrorCode": "xxx api error",
    "Risklevel": -1
}
```

### 杀软检测上报

对应日志报表：终端合规日志->违规杀软日志

对应命令字：7039

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| VirusLibVersion | other | 病毒库版本 | |
| SoftVersion | other | 软件版本 | |
| VirusLibUpdateTime | other | 病毒库更新时间 | |
| Name | string | 杀软名 | |
| ErrorCode | string | 扫描项检查失败的错误信息 | |
| Source | int | 来源 | 0: 未知<br /> 1: 界面触发<br /> 1: 定时器触发<br /> |
| Result | int | 合规检查结果 | 0: 未进行合规检查<br /> 1: 合规<br /> 2: 不合规<br /> 3: 检查失败<br /> |
| Risklevel | int | 风险等级 | |

#### 示例

```json
{
    "VirusLibVersion": {'Value': '1.2.3.4', 'Result': 1},
    "SoftVersion": {'Value': '1.2.3.4', 'Result': 0},
    "VirusLibUpdateTime": {'Value': '2020-04-02 20:42:07', 'Result': 2},
    "Name": "MSE",
    "ErrorCode": "xxx api error",
    "Source": 1,
    "Result": 0,
    "Risklevel": -1
}
```

### IAM登录日志上报

对应日志报表：身份安全日志->用户登录日志

对应命令字：7221

支持版本：7.3+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| TraceID | string | 链路请求ID | l-XXXXXX: l 开头表示登录(login)<br /> c-XXXXXX: c 开头表示挑战认证(challenge)<br /> |
| ClientIP | string | 客户端来源 IP | |
| LoginType | string | 登录类型 | SMS: 短信<br /> Email: 邮件<br /> TOTP: TOTP口令<br /> LDAP: LDAP或WindowsAD<br /> RADIUS: RADIUS<br /> WeCom: 企业微信<br /> WeComPrivate: 政务微信或私有版<br /> DingTalk: 钉钉<br /> Lark: 飞书<br /> OIDC: IAM SSO<br /> OAuth2: IAM SSO<br /> CAS: IAM SSO<br /> iOA: 自建帐密<br /> QRCode: 自建扫码<br /> |
| SendType | string | 发送类型，如果这个字段不为空，表示只发送不验证，此时不用关注 Step 字段 | SMS: 短信<br /> Email: 邮件<br /> |
| ConfigID | string | 配置 ID | |
| DomainID | string | 组织域 ID | |
| UserID | string | 用户账号 | |
| Platform | string | 客户端平台 | |
| DeviceID | string | 设备 ID | |
| Result | bool | 认证/发送结果 | True: 失败<br /> False: 成功<br /> |
| Step | string | 登录步骤 | Login: 登录<br /> MFA: 二次认证或挑战认证<br /> |
| ErrorCode | string | 错误码 | Success: 成功<br /> Fail: 失败<br /> |
| ErrorMsg | string | 错误信息 | |
| Timestamp | int | 上报时间戳 | |
| Scenes | list-string | 场景 | |

#### 示例

```json
{
    "TraceID": "l-XXXXXX",
    "ClientIP": "10.9.32.57",
    "LoginType": "iOA",
    "SendType": "",
    "ConfigID": "3mXyj4eBhc2xxCekzUzhCG",
    "DomainID": "8",
    "UserID": "用户账号",
    "Platform": "Windows",
    "DeviceID": "设备ID",
    "Result": True,
    "Step": "Login",
    "ErrorCode": "Success",
    "ErrorMsg": "错误信息",
    "Timestamp": 1654745421,
    "Scenes": ["DeviceFirstLogin"]
}
```

### 漏洞处理结果上报

对应日志报表：终端安全日志->漏洞修复日志

对应命令字：7009

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| ScanType | int | 扫描类型 | |
| IgnoreType | int | 忽略类型 | |
| TaskId | int | 任务ID | |
| IsDownPatch | int | 是否是补丁下载结果 | |
| ScanId | int | 扫描ID | |
| KB | int | KB号 | |
| Name | string | 漏洞名 | |
| SecLevel | int | 补丁等级 | |
| FixAction | int | 处理方式 | 1: 修复<br /> 2: 忽略<br /> 3: 未处理<br /> |
| FixResult | int | 处理结果 | 0: 失败<br /> 1: 成功<br /> |

#### 示例

```json
{
    "ScanType": 14,
    "IgnoreType": 0,
    "TaskId": 0,
    "IsDownPatch": 0,
    "ScanId": 1676658790,
    "KB": 5022282,
    "Name": "Windows Media中的漏洞可能允许远程代码执行",
    "SecLevel": Windows Media中的漏洞可能允许远程代码执行,
    "FixAction": 3,
    "FixResult": 1
}
```

### 账号设备绑定信息上报

对应日志报表：身份安全日志->帐号绑定终端日志

对应命令字：7222

支持版本：7.3+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| UserID | string | 用户账号 | |
| UserName | string | 用户名 | |
| UID | int | 帐号ID | |
| GroupName | string | 分组名称 | |
| GroupId | int | 分组ID | |
| GroupNamePath | string | 分组名称路径 | |
| GroupIdPath | string | 分组ID路径 | |
| MenuId | int | 目录ID | |
| DeviceType | string | 设备类型 | |
| DeviceId | string | 设备ID | |
| HostName | string | 机器名称 | |
| Ip | string | IP地址 | |
| Mac | string | MAC地址 | |
| Os | string | 操作系统 | |
| NeedBind | int | 是否需要进行绑定处理 | 0: 无需绑定<br /> 1: 需要绑定<br /> |

#### 示例

```json
{
    "UserID": "用户账号",
    "UserName": "用户名",
    "UID": 101,
    "GroupName": "用户分组",
    "GroupId": 123,
    "GroupNamePath": "分组.用户分组",
    "GroupIdPath": "1.123",
    "MenuId": 1,
    "DeviceType": "",
    "DeviceId": "xxx",
    "HostName": "name",
    "Ip": "10.9.32.57",
    "Mac": "",
    "Os": "Windows",
    "NeedBind": 1
}
```

### 远程利用漏洞拦截数据上报

对应日志报表：终端安全日志->网络攻击日志

对应命令字：7028

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| VulId | int | 漏洞拦截自定义id | |
| Attacker | string | 攻击者 | remote: 远程<br /> local: 本地<br /> |
| Payload | string | 攻击流量上抛 | 1: 是<br /> 2: 不是<br /> |
| Brute | int | 是否是爆破拦截上报 | |
| ProtocolType | int | 网络协议类型，取的是IP协议头部里的协议字段 | |
| DestIPv4 | string | 远程ip | |
| OSSp | int | 系统sp版本 | |
| OSPlatform | int | 系统平台id | |
| DestPort | int | 远程端口 | |
| CveId | string | 字符串形式的cveid号，可能有多个，以逗号`;`隔开（Brute=1时或个人版6922无此字段） | |
| Language | int | 系统语言信息 | |
| Win10ReleaseId | int | Win10上面的ReleaseId版本 | |
| SrcPort | int | 本地端口 | |
| IsServer | int | 是否是服务器版本 | 1: 是<br /> 2: 不是<br /> |
| SrcIPv4 | string | 本地ip | |
| OSMajor | int | 系统主版本 | |
| OSBuild | int | 系统build号 | |
| OSMinor | int | 系统次版本 | |
| OnlyReport | int | 是否仅上报不拦截 | 1: 是<br /> 2: 不是<br /> |
| NetDirection | int | 网络出入栈方向 | 1: 入栈<br /> 2: 出栈<br /> |
| ProcessorArc | int | 系统架构 | 0: x86<br /> 9: amd64<br /> |
| Time | int | 攻击时间 | |

#### 示例

```json
{
    "VulId": 0,
    "Attacker": "remote",
    "Payload": "",
    "Brute": 0,
    "ProtocolType": 6,
    "DestIPv4": "192.168.0.130",
    "OSSp": 0,
    "OSPlatform": 2,
    "DestPort": 64587,
    "CveId": "CVE-2017-0144",
    "Language": 2052,
    "Win10ReleaseId": 2009,
    "SrcPort": 80,
    "IsServer": 2,
    "SrcIPv4": "192.168.0.130",
    "OSMajor": 10,
    "OSBuild": 19042,
    "OSMinor": 0,
    "OnlyReport": 1,
    "NetDirection": 2,
    "ProcessorArc": 9,
    "Time": 1618382918
}
```

### 无端访问日志上报

对应日志报表：资源访问日志->Web访问日志

对应命令字：7233

支持版本：7.3+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| id | string | 流水ID | |
| domain_id | string | 组织域id | |
| user_id | string | 用户id | |
| name | string | 用户名称 | |
| upload_time | string | 上传时间 | |
| access_time | string | 访问时间 | |
| ip | string | 访问来源 | |
| auth_type | string | 授权类型 | |
| resource_type | string | 资源类型 | api: api<br /> app: app<br /> |
| resource_id | string | 资源ID | |
| resource_name | string | 资源名称 | |
| protocol | string | 访问协议 | |
| domain | string | 访问域名 | |
| port | string | 访问端口 | |
| uri | string | 访问的URI | |
| target | string | 代理业务RS | |
| target_uri | string | 代理业务的URI | |
| status | string | HTTP状态码 | |
| authorize | string | 策略响应码 | |
| user_agent | string | 浏览器信息 | |
| err_msg | string | 错误信息 | |

#### 示例

```json
{
    "id": "188106c3-8235-4fa9-b31f-e9a1162568e4",
    "domain_id": "121",
    "user_id": "2155",
    "name": "张三",
    "upload_time": "2020-11-23T08:13:12+08:00",
    "access_time": "2020-11-23T08:13:12+08:00",
    "ip": "220.12.3.203",
    "auth_type": "system",
    "resource_type": "api",
    "resource_id": "6",
    "resource_name": "hr系统",
    "protocol": "https",
    "domain": "hr.test05.g-proxy.com",
    "port": "8082",
    "uri": "/user?id=1",
    "target": "http://10.0.2.5:5002",
    "target_uri": "/user",
    "status": "200",
    "authorize": "200",
    "user_agent": "mozilla/5.0",
    "err_msg": ""
}
```

### 设备禁用上报

对应日志报表：终端管控日志->设备禁用日志

对应命令字：7021

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| instance | string | 实例路径 | |
| name | string | 友好名字 | |
| class_guid | string | 类 | |
| class_name | string | 类名 | |

#### 示例

```json
{
    "instance": "xxx",
    "name": "xxx",
    "class_guid": "xxx",
    "class_name": "xxx"
}
```

### 网络文件收发日志

对应日志报表：终端安全日志->网络文件收发日志

对应命令字：7244

支持版本：7.1

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| ProcessName | string | 进程名 | |
| MD5 | string | 文件MD5值 | |
| FilePath | string | 文件路径 | |
| Timestamp | int | 上报时间戳 | |

#### 示例

```json
{
    "ProcessName": "wechat",
    "MD5": "7F90F66F0B48F8ACBB9E486CC8CE02B9",
    "FilePath": "c:\windows\1.exe",
    "Timestamp": 1654745421
}
```

### 终端进程违规信息上报

对应日志报表：终端管控日志->进程管控日志

对应命令字：7036

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Type | int | 类型 | 1: 进程运行行为监控<br /> 2: 进程运行行为拦截<br /> |
| Name | string | 进程名称 | |
| Name | string | 进程路径 | |
| CmdLine | string | 命令行 | |
| UserName | string | 用户名 | |

#### 示例

```json
{
    "Type": 1,
    "Name": "aaa.exe",
    "Name": "C:\Program Files\aaa.exe",
    "CmdLine": "arg1 arg2",
    "UserName": "SYSTEM"
}
```

### 外联检测上报

对应日志报表：终端管控日志->非法外联日志

对应命令字：7033

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| MAC | string | MAC地址 | |
| IP | string | IP地址 | |
| DetectType | int | 探测类型 | 0: 终端探测<br /> 1: 互联网探测<br /> |
| TerminalDetectType | int | 终端探测类型 | 0: 解析域名<br /> 1: ping探测地址<br /> 2: tcp建立连接<br /> |
| InternetDetectUrl | string | 数据服务器地址 | |
| DetectResult | int | 探测结果 | 0: 合法<br /> 1: 非法<br /> |

#### 示例

```json
{
    "MAC": "00-50-56-C0-00-01",
    "IP": "1.1.1.1",
    "DetectType": 0,
    "TerminalDetectType": 0,
    "InternetDetectUrl": "http://test.com/api/ip",
    "DetectResult": 0
}
```

### 网络审计DNS访问上报

对应日志报表：终端安全日志->信息采集日志->DNS网络协议

对应命令字：7065

支持版本：7.3+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Category | string | 类型 | |
| ID | string | 会话ID | |
| QueryResult | string | DNS返回内容 | |
| Type | string | DNS类型 | |
| UtcTime | string | 日志采集时间 | |

#### 示例

```json
{
    "Category": "DnsRecord",
    "ID": "33656",
    "QueryResult": "www.freebuf.com=182.92.184.192,",
    "Type": "A",
    "UtcTime": "2023-03-02 20:20:23"
}
```

### 文件访问控制上报

对应日志报表：终端管控日志->文件管控日志->文件访问与操作

对应命令字：7501

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| time | string | 本次策略监控结果生成的时间 | |
| acces_time | string | 访问时间 | |
| category | string | 上传类型 | |
| create_time | string | 创建时间 | |
| dst_filename | string | 目标文件路径 | |
| dst_vol_type | string | 目标设备类型 | 1: HARDISK<br /> 2: UDISK<br /> 3: CDROM<br /> 4: NETSHARE<br /> 5: HTTP<br /> 6: FTP<br /> |
| filesize | string | 文件大小 | |
| filetfinger | string | 源文件tfinger | |
| md5 | string | 源文件MD5 | |
| modify_time | string | 修改时间 | |
| operation | string | 文件操作类型 | 1: 创建<br /> 2: 复制<br /> 3: 移动<br /> 4: 删除<br /> 5: 重命名<br /> 6: 读取<br /> 7: 写入<br /> |
| process_id | string | 进程ID | |
| process_name | string | 进程名 | |
| process_path | string | 进程全路径 | |
| src_filename | string | 源文件路径 | |
| src_vol_type | string | 源设备类型 | 1: HARDISK<br /> 2: UDISK<br /> 3: CDROM<br /> 4: NETSHARE<br /> 5: HTTP<br /> 6: FTP<br /> |

#### 示例

```json
{
    "time": "2023-02-20 11:13:28",
    "acces_time": "2023-02-20 11:13:28",
    "category": "fileoperation",
    "create_time": "2021-01-12 15:54:07",
    "dst_filename": "/dest/file",
    "dst_vol_type": "2",
    "filesize": "150168",
    "filetfinger": "1034",
    "md5": "7F90F66F0B48F8ACBB9E486CC8CE02B9",
    "modify_time": "2023-02-20 11:12:45",
    "operation": "4",
    "process_id": "2516",
    "process_name": "Explorer.exe",
    "process_path": "C:\windows\Explorer.exe",
    "src_filename": "F:\iOA_Enterprise_dev\7.2\client\ftcommon\Projects\FTCommonBuild.sln",
    "src_vol_type": "2"
}
```

### 开关机上报

对应日志报表：客户端操作日志->开机关机日志

对应命令字：7015

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| LastTime | int | 关机时间 | |
| StartUp | int | 开机时间 | |
| Action | int | 行为 | 1: 开机<br /> 2: 关机<br /> |

#### 示例

```json
{
    "LastTime": 1677764385,
    "StartUp": 1677764412,
    "Action": 1
}
```

### 主防风险上报

对应日志报表：终端安全日志->实时防护日志

对应命令字：7003

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Action | int | 行为 | 1: 忽略<br /> 2: 阻止<br /> 3: 允许<br /> |
| RiskRuleId | int | 风险规则ID | |
| RiskTitle | string | 风险名 | |
| AutoDefaultAction | int | 自动默认行为 | 1: 无Tray默认响应<br /> 2: 非“无Tray默认响应”<br /> |
| MonitorId | int | 监控点 | |
| Operation | int | 操作类型 | |
| MonitorGroupId | int | 监控组 | |
| CloudHitType | int | 命中云类型 | |
| RawSubFilePath | string | 原始子路径 | |
| OptProcPath | string | 操作者路径 | |
| OptThreadPath | string | 线程模块名 | |
| SubFilePath | string | 子进程路径 | |
| Time | int | 攻击时间 | |
| ProcessChain | list-string | 命令行 | |
| PhishLog | int | 是否上传钓鱼日志 | 1: 是钓鱼日志 支持版本:8.x |
| PhishRiskTitle | string | 钓鱼告警名称 | 支持版本:8.x |
| PhishDetectEngine | string | 钓鱼告警引擎 | 支持版本:8.x |
| PhishStage | string | 钓鱼告警阶段 | 支持版本:8.x |
| PhishSource | string | 钓鱼来源 | 支持版本:8.x |
| PhishSourceProduct | string | 钓鱼产品 | 支持版本:8.x |
| PhishType | int | 钓鱼类型 | 支持版本:8.x |
| PhishFile | string | 钓鱼文件 | 支持版本:8.x |
| PhishFileMd5 | string | 钓鱼文件md5 | 支持版本:8.x |
| PhishFixResult | int | 钓鱼结果 | 支持版本:8.x |
| PhishUrl | string | 钓鱼外联IP | 支持版本:8.x |
| PhishIP | string | 钓鱼外联地址 | 支持版本:8.x |
| PhishChain | string | 钓鱼攻击链 | 支持版本:8.x |
| PhishDetails | string | 钓鱼详情 | 支持版本:8.x |

#### 示例

```json
{
    "Action": 1,
    "RiskRuleId": 0,
    "RiskTitle": "发现挂马攻击！",
    "AutoDefaultAction": 1,
    "MonitorId": 2801,
    "Operation": 1,
    "MonitorGroupId": 0,
    "CloudHitType": 2,
    "RawSubFilePath": "c:\windows\2.exe",
    "OptProcPath": "c:\windows\2.exe",
    "OptThreadPath": "c:\windows\a.dll",
    "SubFilePath": "c:\windows\1.exe",
    "Time": 1618382918,
    "ProcessChain": ["c:\windows\explorer.exe"],
    "PhishLog":1,// 1开启 0 关闭
	"PhishRiskTitle":"",  //告警名称
	"PhishDetectEngine":1, //检测引擎 0 未知 1 云查引擎 2 TAV(包含yara引擎) 3 系统修复引擎 4 黑名单 5 社工防护引擎
	"PhishStage":4, //检出阶段 1 传输落地 2 执行加载 3 行为对抗 4  外联C2
	"PhishSource":"wechat.exe",	//钓鱼来源
	"PhishSourceProduct":"微信", //钓鱼来源产品名
	"PhishType": 1, //1 IM(即时通讯) 2 邮件 3 浏览器 4 下载工具 5 网盘 6 管理工具 7 其他渠道
	"PhishFile":"",		//文件路径
	"PhishFileMd5":"",	//文件md5
	"PhishFixResult":1, //处理结果 1 已删除文件 2 已阻断告警进程 3 已阻断进程行为 4 已拦截进程联网 5 未处置 6 处置失败 7 已允许
	"PhishUrl":"", //域名或i
	// 钓鱼溯源链 
	// type 1 文件 2 进程 3 注册表 4 网络 5 系统 6 横移
	// type1 action 1 下载 2 释放 3 修改 4 删除 5 覆盖 6 重命名 7 创建 8 HardLink 9 PendingRename 10 DllHjack 11 DenyWrite
	// type2 action 1 进程创建  2 注入 3 lnk执行 4 执行 5 OpenProcess 6 ReadProcessMemory 7 WriteProcessMemory 8 TeminateProcess 9 Hook 10 CreateProcess 11 ExitProcess 12 CreateRemoteThread 13 TerminateThread 14 SuspendThread 15 QueueApc 16 ThreadSetContext 17 ThreadCreate 18 ThreadExit 19 DumpLsass 20 DotnetLoad
	// type3 action 1 CreateKey 2 DeleteKey 3 ModifyKey 4 CreateValue 5 ModifyValue 6 DeleteValue 7 QueryValue
	// type4 action 1 外联C2 Connect
	// type5 action 1 ChangeService 2 DeleteService 3 ShowWindow 4 SetWindowPos 5 SetWindowLong 6 SimulateClick 7 DeviceIoControl 8 SystemReboot 9 WmiProc 10 MemScan
	// type6 action :1 本地服务创建, 2 本地服务启动, 3 本地服务修改, 4 本地删除服务  5 本地停止服务 6 高危com调用 
	"PhishChain":[{"type":1,"action":1, "src":"微信.exe", "target":"1.rar"},{"type":1, "action":1, "src":"1.rar", "target":"1.exe"}, {"type":4, "action":1, "src":"1.exe", "target":"IP/域名"}],
    //钓鱼详情
	"PhishDetails":{"OptProcId":"","OptProcPath":"","OptProcCmd":"","OptProcFileMd5":"","ChildProcId":"","ChileProcPath":"","ChildProcCmd":"","ChildProcFileMd5":"","Ip":"","Domain":"","TrojanName":"","ParentProcId":"","ParentProcPath":"","ParentProcCmd":"","ParentProcFileMd5":"","ThreadId":"","ThreadFilePath":"","ThreadFileMd5":"","FileMd5":"","FilePath":"","SubFilePath":"","SubFileMd5":"","TargetFileMd5":"","TargetFilePath":"","Md5":"","Target":"","Object":"","RegPath":"","RegValueData":"","RegValueName":"","RegValueType":"","Operation":"","ServiceName":"","ServiceType":""}
}
```

### 服务违规状态上报

对应日志报表：终端合规日志->违规服务日志

对应命令字：7046

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| ViolationList | list-string | 不合规的服务列表 | |
| ErrorCode | string | 扫描项检查失败的错误信息 | |
| Source | int | 来源 | 0: 未知<br /> 1: 界面触发<br /> 1: 定时器触发<br /> |
| Result | int | 合规检查结果 | 0: 未进行合规检查<br /> 1: 合规<br /> 2: 不合规<br /> 3: 检查失败<br /> |
| Risklevel | int | 风险等级 | |

#### 示例

```json
{
    "ViolationList": ["服务名A"],
    "ErrorCode": "xxx api error",
    "Source": 1,
    "Result": 0,
    "Risklevel": -1
}
```

### 程序黑白名单检查上报

对应日志报表：终端合规日志->违规软件日志

对应命令字：7041

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| WhiteListNotin | other | 白名单程序 | |
| BlackListIn | other | 黑名单程序 | |
| ErrorCode | string | 扫描项检查失败的错误信息 | |
| Source | int | 来源 | 0: 未知<br /> 1: 界面触发<br /> 1: 定时器触发<br /> |
| Result | int | 合规检查结果 | 0: 未进行合规检查<br /> 1: 合规<br /> 2: 不合规<br /> 3: 检查失败<br /> |
| Risklevel | int | 风险等级 | |

#### 示例

```json
{
    "WhiteListNotin": [{'Name': 'QQ'}, {'Name': '微信'}],
    "BlackListIn": [{'Name': '软件A'}],
    "ErrorCode": "xxx api error",
    "Source": 1,
    "Result": 0,
    "Risklevel": -1
}
```

### 补丁检查上报

对应日志报表：终端合规日志->违规漏洞日志

对应命令字：7040

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| NoKBList | list-string | 不合规的KB列表 | |
| ErrorCode | string | 扫描项检查失败的错误信息 | |
| Source | int | 来源 | 0: 未知<br /> 1: 界面触发<br /> 1: 定时器触发<br /> |
| Result | int | 合规检查结果 | 0: 未进行合规检查<br /> 1: 合规<br /> 2: 不合规<br /> 3: 检查失败<br /> |
| Risklevel | int | 风险等级 | |

#### 示例

```json
{
    "NoKBList": ["123"],
    "ErrorCode": "xxx api error",
    "Source": 1,
    "Result": 0,
    "Risklevel": -1
}
```

### 代理访问日志上报

对应日志报表：资源访问日志->客户端访问日志->代理访问日志

对应命令字：7055（6.X）/7370（7.X+）

支持版本：6.X/7.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| datestamp | string | 日期时间戳 | |
| target | string | 目标 | 未开启HTTPS卸载功能时不包含详细URL，开启后包含详细URL |
| duration | string | 持续时间 | |
| remoteAddress | string | 远程地址 | |
| remotePort | string | 远程端口 | |
| remoteFamily | string | 远程协议族 | |
| localAddress | string | 本地地址 | |
| localPort | string | 本地端口 | |
| localIpPort | string | 本地IP端口 | |
| targetHost | string | 目标主机 | |
| targetPort | string | 目标端口 | |
| authorization | string | 授权信息 | |
| forwardedFor | string | 转发来源 | |
| userAgent | string | 用户代理 | |
| sourceName | string | 源名称 | |
| errinfo | string | 错误信息 | |
| urlAudit | bool | URL审计管控 | |

#### 示例

```json
{
    "datestamp": "2024-01-17T08:07:01.146Z",
    "target": "www.baidu.com:443",
    "duration": "100",
    "remoteAddress": "127.0.0.1",
    "remotePort": "80",
    "remoteFamily": "IPv4",
    "localAddress": "127.0.0.1",
    "localPort": "28880",
    "localIpPort": "127.0.0.1:80",
    "targetHost": "127.0.0.1",
    "targetPort": "443",
    "authorization": "Basic eyJJZCI6IjAXXX",
    "forwardedFor": "127.0.0.1",
    "userAgent": "Mozilla/5.0 (Windows NT 10.0; WOW64)",
    "sourceName": "tcp",
    "errinfo": "",
    "requestBytes": "2769",
    "responseBytes": "2284",
    "serviceId": "111",
    "urlAudit": "off"
}
```

注意：部分版本上报内容在 `message` 字段中，需要解析后使用，内容示例如下

```
"datestamp","target","duration","remoteAddress","remotePort","remoteFamily","localAddress","localPort","localIpPort","targetHost","targetPort","authorization","forwardedFor","userAgent","sourceName","errinfo","requestBytes","responseBytes","serviceId","urlAudit"
```

### 动态访问控制日志上报

对应日志报表：资源访问日志->客户端访问日志->动态访问控制日志

对应命令字：7249

支持版本：8.1+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| RequestId | string | 请求id | |
| TenantId | string | 租户id | |
| StrategyId | int | 命中的策略id，0为不命中 | |
| StrategyName | string | 命中的策略名 | |
| DeviceID | string | mid | |
| ProcessName | string | 进程名 | |
| ServiceId | int | 资源id | |
| ServiceAddress | string | 资源地址 | |
| Destination | string | 目标ip | |
| DestinationPort | int | 目标端口 | |
| Source | string | 源ip | |
| SourcePort | int | 源端口 | |
| ClientIp | string | 客户端ip | |
| Action | string | Action | allow: 允许访问<br /> deny: 禁止访问<br /> audit: 审计<br /> require: 限制访问<br /> |
| CreateTime | int | 时间 | |
| Details | string | 访问详情 | |

#### 示例

```json
{
    "RequestId": "879ea73a-b3be-4de2-8748-42cadfb2afd2",
    "TenantId": "on-premise",
    "StrategyId": 1,
    "StrategyName": "策略",
    "DeviceID": "59747AE174481D5C109FF7B619730BFA6477FFC7",
    "ProcessName": "WeChatAppEx.exe",
    "ServiceId": 123,
    "ServiceAddress": "docs.qq.com:443",
    "Destination": "docs.qq.com",
    "DestinationPort": 443,
    "Source": "192.168.255.10",
    "SourcePort": 63261,
    "ClientIp": "10.0.0.1",
    "Action": "require",
    "CreateTime": 1654745421,
    "Details": "{\"request\":\"...\"}"
}
```

### 高级威胁防护告警日志上报

对应命令字：7510

支持版本：8.2

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
|EventId |int64 |告警ID（7日内重复告警使用相同的ID） | |
|EventName |string |告警名称 | |
|IOAAccount |string |企业账号 | |
|AttackSummary |string |告警攻击摘要 | |
|OccurTime |int64 |发生时间戳（毫秒） | |
|EngineName |string |引擎名称 |CloudEngine:云引擎 <br>GraphEngine:关联图引擎<br>IocEngine:威胁情报<br>TavEngine:TAV引擎 |
|PolicyName |string |触发策略名称 | |
|PolicyDescription |string |触发策略描述 | |
|RiskLevel |int32 |风险等级 |1:低危<br>2:中危<br>3:高危 |
|AttackTech |[]string |ATT&CK战技术编号 |参见：https://attack.mitre.org/ |
|Mid |string |终端mid | |
|TerminalName |string |终端名称 | |
|OnlineStatus |int32 |在线状态 |1:离线<br>2:在线<br>3:未授权 |
|Ostype |int32 |终端系统类型 |0:windows<br>1:linux<br>2:macOS<br>3:windows server<br>4:android<br>5:iOS |
|Source |string |告警源节点 | |
|Target |string |告警目标节点 | |
|ActionType |string |动作类型 |见7520采集日志动作类型取值范围 |
|ActionName |string |动作名称 |见7520采集日志子动作名称取值范围 |
|OriginLog |map |原始上报日志（详见7520高级威胁防护采集日志上报） | |

#### 示例

```json
{
    "_type": "Event_7510",
    "recvTime": "2023-12-18T23:26:11+08:00",
    "sender": {
        "_type": "Terminal",
        "mid": "",
        "publicIP": "",
        "clientVersion": "0.0.0.0",
        "client": {
            "IpPort": "",
            "Mid": "",
            "Guid": "",
            "Mac": "",
            "Name": "",
            "User": "",
            "OSType": 0,
            "OS": "",
            "GroupIDPath": "",
            "GroupNamePath": "",
            "Account": "",
            "Version": 0,
            "GroupId": 0,
            "GroupName": "",
            "AccountGroupId": 0,
            "AccountName": "",
            "AccountGroupName": "",
            "AccountGroupIdPath": "",
            "AccountGroupNamePath": "",
            "AccountVirtualGroupId": 0,
            "AccountVirtualGroupName": ""
        },
        "src": null
    },
    "args": {
        "ActionName": "ProcessCreate",
        "ActionType": "Proc",
        "AttackSummary": "\"kylinssoclient (deleted)\"进程 创建 \"ping\"进程",
        "AttackTech": [
            "TA0007",
            "TA0006"
        ],
        "EngineName": "GraphEngine",
        "EventId": 1367,
        "EventName": "测试linux告警ping",
        "IOAAccount": "testing",
        "Mid": "0000000000000000000000000000000000000000",
        "OccurTime": 1702913084087,
        "OnlineStatus": 2,
        "OriginLog": {
            "@collection": "2023-12-18T23:24:44.087+08:00",
            "@timestamp": "2023-12-18T23:24:59.982462743+08:00",
            "Action": {
                "Name": "ProcessCreate",
                "NodeMergeId": "/usr/sbin/kylinssoclient (deleted)_aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa_processcreate_/usr/bin/ping_0aef4d6aec3105d4461445da130adc47",
                "Type": "Proc"
            },
            "Alert": {
                "ActionShow": "ProcessCreate",
                "AlertSource": "",
                "BlockType": "",
                "ChildShow": "ping",
                "CloudEngineName": "",
                "CloudRuleId": 0,
                "CloudTitle": "",
                "EngineName": "GraphEngine",
                "EventUuid": "",
                "FixResult": "",
                "ParentShow": "kylinssoclient (deleted)",
                "RuleId": 0,
                "RuleName": "",
                "RuleNature": ""
            },
            "Child": {
                "CallStack": "",
                "CloudAttr": "Unknown",
                "FileAccessTime": 0,
                "FileCompany": "",
                "FileCopyright": "",
                "FileCreateTime": 0,
                "FileDesc": "",
                "FileDriverType": "",
                "FileFormat": "SO",
                "FileIssuer": "",
                "FileLegalMark": "",
                "FileMd5": "0aef4d6aec3105d4461445da130adc47",
                "FileMd5Type": "FullMd5",
                "FileModifyTime": 1580425883,
                "FileName": "ping",
                "FileOriginalName": "",
                "FilePath": "/usr/bin/ping",
                "FileProductName": "",
                "FileProductVer": "",
                "FileSign": "",
                "FileSignStatus": "",
                "FileSignWhite": 0,
                "FileSize": 72776,
                "FileStream": "",
                "FileTags": "",
                "FileVersion": "",
                "ProcArch": "",
                "ProcChainInfo": "kylinssoclient (deleted)_Trust_1814",
                "ProcChainTrust": "Trust",
                "ProcCmdline": "/usr/bin/ping 8.8.8.8 -c1",
                "ProcCmdline-raw": "",
                "ProcCpuArch": "amd64",
                "ProcCurDir": "",
                "ProcDesktop": "",
                "ProcDomainName": "",
                "ProcElevationType": 0,
                "ProcExited": false,
                "ProcGuid": "9045350895302169775",
                "ProcIntegrity": 0,
                "ProcPid": 2970799,
                "ProcTrust": "Trust",
                "ProcUserName": "",
                "ScanAttr": "Unknown",
                "ScriptContent": "",
                "ThreadId": 0,
                "TrojanName": "",
                "Type": "Proc"
            },
            "Common": {
                "AuthId": 0,
                "ClientVer": "",
                "DeviceGroup": "全网终端.未分组终端",
                "EventId": 28246,
                "EventTime": 1702913084087,
                "EventUUId": "bf81027b-82a3-4b6b-9bea-6ef96b2fb65c",
                "Guid": "",
                "KernelId": 0,
                "LoginStatus": 2,
                "Mid": "0000000000000000000000000000000000000000",
                "MonitorName": "",
                "ReportId": 5058,
                "SessionId": 15,
                "Source": "",
                "Uid": 0,
                "UserName": "testing"
            },
            "Environment": {
                "DomainName": "",
                "ExportIp": "",
                "HostName": "testing-VMware-Virtual-Platform",
                "MacAddr": "00-0c-29-7e-9c-ee",
                "OsBit": "64",
                "OsBuild": 0,
                "OsProduectDesc": "",
                "OsType": "Linux",
                "OsUserName": "testing",
                "OsVersion": "Kylin V10 SP1",
                "SysStartTimes": 1702348874000
            },
            "Event": {
                "AttackTech": "TA0007,TA0006",
                "EngineName": "GraphEngine",
                "EventId": 1367,
                "EventName": "测试linux告警ping",
                "RiskLevel": 2
            },
            "OS": "1",
            "Parent": {
                "CloudAttr": "",
                "FileAccessTime": 0,
                "FileCompany": "",
                "FileCopyright": "",
                "FileCreateTime": 0,
                "FileDesc": "",
                "FileDriverType": "",
                "FileFormat": "",
                "FileIssuer": "",
                "FileLegalMark": "",
                "FileMd5": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "FileMd5Type": "FullMd5",
                "FileModifyTime": 0,
                "FileName": "kylinssoclient (deleted)",
                "FileOriginalName": "",
                "FilePath": "/usr/sbin/kylinssoclient (deleted)",
                "FileProductName": "",
                "FileProductVer": "",
                "FileSign": "",
                "FileSignStatus": "",
                "FileSignWhite": 0,
                "FileSize": 0,
                "FileTags": "",
                "FileVersion": "",
                "ProcArch": "",
                "ProcChainGuid": "8930008985805848577,6622091318409560065",
                "ProcChainInfo": "",
                "ProcChainTrust": "Trust",
                "ProcCmdline": "/usr/sbin/kylinssoclient",
                "ProcCmdline-raw": "",
                "ProcCpuArch": "amd64",
                "ProcDomainName": "",
                "ProcElevationType": 0,
                "ProcExited": false,
                "ProcGuid": "8930009183374346006",
                "ProcIntegrity": 0,
                "ProcPid": 1814,
                "ProcTrust": "Trust",
                "ProcUserName": "",
                "ScanAttr": "Unknown",
                "ThreadId": 0,
                "TrojanName": "",
                "Type": "Proc"
            },
            "Uuid": "33078ed407575b8490fee13bafc1c923_28246",
            "Version": 1,
            "_id": "uTeHfYwBTDbys-ncyP_P"
        },
        "Ostype": 0,
        "PolicyDescription": "testing配置的",
        "PolicyName": "测试linux告警ping",
        "RiskLevel": 2,
        "Source": "\"kylinssoclient (deleted)\"",
        "Target": "\"ping\"",
        "TerminalName": "testing-VMware-Virtual-Platform"
    }
}
```

### 高级威胁防护采集日志上报

对应命令字：7520

支持版本：7.5

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| :--- | :--- | :--- | :--- |
| OS | int | 系统平台 |  |
| Uuid | string | 唯一ID |  |
| @collection | datetime | 采集时间 |  |
| @timestamp | datetime | 入库时间 |  |
| Cmd | string | 命令字 |  |
| Version | int | 数据版本 |  |
| Action | object | 动作 |  |
| Action.Type | string | 事件动作类型 | 见采集日志动作类型取值范围 |
| Action.Name | string | 事件动作名称 | 见采集日志子动作名称取值范围 |
| Action.EventLogId | int | Windows日志ID |  |
| Parent | object | 操作者节点 |  |
| Parent.ProcPid | int | 进程Pid |  |
| Parent.ProcCmdline | string | 进程命令行 |  |
| Parent.FileName | string | 文件名 |  |
| Parent.FilePath | string | 文件路径 |  |
| Parent.FileDriverType | string | 驱动器类型 | CDRom: CD光盘<br/>Fixed: 硬盘<br/>NoRootDir: 非驱动<br/>Ramdisk: 内存磁盘<br/>Remote: 网络驱动器<br/>Removeable: 可移动介质<br/>Unknown: 未知 |
| Parent.FileMd5 | string | 文件md5 |  |
| Parent.CloudAttr | string | 云查属性 | Black: 黑\(Black\)<br/>Gray: 灰\(Gray\)<br/>Unknown: 未知\(Unknown\)<br/>White: 安全\(White\) |
| Parent.Type | string | 节点类型 | ApiCall: 系統API<br/>File: 文件<br/>FileStatics: 文件统计<br/>Log: 日志<br/>Network: 网络<br/>Pipe: 管道<br/>Pipe: 管道<br/>Proc: 进程<br/>Reg: 注册表<br/>Script: 脚本 |
| Parent.ProcGuid | string | 进程唯一ID |  |
| Parent.ProcIntegrity | int | 进程完整性级别 | 1: 不可信<br/>2: 低<br/>3: 中<br/>4: 中+<br/>5: 高<br/>6: 系统<br/>7: 保护进程 |
| Parent.ProcElevationType | int | 进程提权类型 | 1: UAC关闭<br/>2: UAC提权<br/>3: UAC限制权限 |
| Parent.ProcUserName | string | 进程用户名 |  |
| Parent.ProcDomainName | string | 进程用户域名 |  |
| Parent.ProcArch | string | 进程架构 | x64: x64<br/>x86: x86 |
| Parent.ProcTrust | string | 进程可信 | NoTrust: 不可信<br/>Trust: 可信 |
| Parent.ProcChainTrust | string | 进程链可信 | NoTrust: 不可信<br/>Trust: 可信 |
| Parent.ProcChainInfo | string | 进程链详情 |  |
| Parent.FileFormat | string | 文件类型 | DLL: 动态链接库<br/>EXE: 可执行EXE<br/>NPE: 非PE<br/>SYS: 驱动 |
| Parent.FileMd5Type | string | 文件md5类型 | FullMd5: 全文<br/>HalfMd5: 半文 |
| Parent.FileSize | int | 文件大小 |  |
| Parent.FileSign | string | 文件签名 |  |
| Parent.FileSignStatus | string | 文件签名状态 | Expired: 签名过期<br/>Invalid: 验证不通过<br/>Valid: 验证通过 |
| Parent.FileSignWhite | int | 是否白签名 | 0: 不是<br/>1: 是 |
| Parent.FileIssuer | string | 签名颁发机构 |  |
| Parent.FileCompany | string | 文件公司名 |  |
| Parent.FileDesc | string | 文件描述 |  |
| Parent.FileVersion | string | 文件版本 |  |
| Parent.FileOriginalName | string | 原始文件名 |  |
| Parent.FileProductName | string | 文件产品名 |  |
| Parent.FileProductVer | string | 文件产品版本号 |  |
| Parent.FileLegalMark | string | 文件产品商标 |  |
| Parent.FileCopyright | string | 文件版权 |  |
| Parent.FileModifyTime | int | 文件修改时间 |  |
| Parent.FileAccessTime | int | 文件访问时间 |  |
| Parent.FileCreateTime | int | 文件创建时间 |  |
| Parent.FileTags | string | 文件标签 | Browser: 浏览器渠道<br/>Browser:114高速浏览器: 114高速浏览器下载<br/>Browser:115极速浏览器: 115极速浏览器下载<br/>Browser:115浏览器: 115浏览器下载<br/>Browser:2345加速浏览器: 2345加速浏览器下载<br/>Browser:2345智能浏览器: 2345智能浏览器下载<br/>Browser:360安全浏览器: 360安全浏览器下载<br/>Browser:360极速浏览器: 360极速浏览器下载<br/>Browser:Edge浏览器: Edge浏览器下载<br/>Browser:GreenBrowser: GreenBrowser下载<br/>Browser:GT游戏浏览器: GT游戏浏览器下载<br/>Browser:hao123桔子浏览器: hao123桔子浏览器下载<br/>Browser:IE浏览器: IE浏览器下载<br/>Browser:iQ浏览器: iQ浏览器下载<br/>Browser:KR浏览器: KR浏览器下载<br/>Browser:MyIE浏览器: MyIE浏览器下载<br/>Browser:Opera: Opera下载<br/>Browser:QQ浏览器: QQ浏览器下载<br/>Browser:Safari浏览器: Safari浏览器下载<br/>Browser:Spartan浏览器: Spartan浏览器下载<br/>Browser:TT浏览器: TT浏览器下载<br/>Browser:UC浏览器: UC浏览器下载<br/>Browser:YY浏览器: YY浏览器下载<br/>Browser:世界之窗浏览器: 世界之窗浏览器下载<br/>Browser:世界之窗浏览器极速版: 世界之窗浏览器极速版下载<br/>Browser:傲游浏览器: 傲游浏览器下载<br/>Browser:搜狗浏览器: 搜狗浏览器下载<br/>Browser:淘宝浏览器: 淘宝浏览器下载<br/>Browser:火狐浏览器: 火狐浏览器下载<br/>Browser:猎豹浏览器: 猎豹浏览器下载<br/>Browser:瑞影浏览器: 瑞影浏览器下载<br/>Browser:百度浏览器: 百度浏览器下载<br/>Browser:百度浏览器hao123专版: 百度浏览器hao123专版下载<br/>Browser:糖果浏览器: 糖果浏览器下载<br/>Browser:花儿世界浏览器: 花儿世界浏览器下载<br/>Browser:谷歌浏览器: 谷歌浏览器下载<br/>Browser:超速浏览器: 超速浏览器下载<br/>Browser:闪游浏览器: 闪游浏览器下载<br/>Browser:随E浏览器: 随E浏览器下载<br/>Browser:青猴浏览器: 青猴浏览器下载<br/>Downloader: 下载器渠道<br/>Downloader:BitComet: BitComet下载<br/>Downloader:IDMan: IDMan下载<br/>Downloader:QQ旋风: QQ旋风下载<br/>Downloader:QQ旋风下载助手: QQ旋风下载助手下载<br/>Downloader:RaySource: RaySource下载<br/>Downloader:旋风高速下载引擎: 旋风高速下载<br/>Downloader:比特彗星: 比特彗星下载<br/>Downloader:电驴: 电驴下载<br/>Downloader:百度下载助手: 百度下载助手下载<br/>Downloader:百度云管家: 百度云管家下载<br/>Downloader:网际快车: 网际快车下载<br/>Downloader:网页迅雷: 网页迅雷下载<br/>Downloader:迅雷: 迅雷下载<br/>Downloader:迅雷云加速: 迅雷云加速下载<br/>Downloader:迅雷精简版: 迅雷精简版下载<br/>Downloader:迅雷迷你版: 迅雷迷你版下载<br/>Downloader:迷你快车: 迷你快车下载<br/>Downloader:迷你电驴: 迷你电驴下载<br/>Downloader:飞鸟下载器: 飞鸟下载器下载<br/>IM: IM渠道<br/>IM:FSLink: FSLink下载<br/>IM:MSN: MSN下载<br/>IM:Skype: Skype下载<br/>IM:YY语音: YY语音下载<br/>IM:京东咚咚: 京东咚咚下载<br/>IM:企业微信: 企业微信下载<br/>IM:微信: 微信下载<br/>IM:易信: 易信下载<br/>IM:润工作: 润工作下载<br/>IM:环信: 环信下载<br/>IM:百度Hi: 百度Hi下载<br/>IM:百度Hi: 百度Hi下载<br/>IM:网易CC语音: 网易CC语音下载<br/>IM:网易云信: 网易云信下载<br/>IM:腾讯QQ: 腾讯QQ下载<br/>IM:腾讯TM: 腾讯TM下载<br/>IM:腾讯通\(RTX\): 腾讯通\(RTX\)下载<br/>IM:钉钉: 钉钉下载<br/>IM:阿里旺旺: 阿里旺旺下载<br/>IM:飞书: 飞书下载<br/>IM:飞信: 飞信下载<br/>Mail: 邮箱渠道<br/>Mail:139邮箱: 139邮箱下载<br/>Mail:Foxmail: Foxmail下载<br/>Mail:PP助手: OutLook下载<br/>Mail:新浪邮箱: 新浪邮箱下载<br/>Mail:网易邮箱: 网易邮箱下载<br/>Mail:阿里邮箱: 阿里邮箱下载<br/>NetDisk: 网盘渠道<br/>NetDisk:115网盘: 115网盘下载<br/>NetDisk:360云盘: 360云盘下载<br/>NetDisk:360网盘: 360网盘下载<br/>NetDisk:优蛋: 优蛋下载<br/>NetDisk:华为网盘: 华为网盘下载<br/>NetDisk:坚果云: 坚果云下载<br/>NetDisk:城通网盘: 城通网盘下载<br/>NetDisk:天翼云盘: 天翼云盘下载<br/>NetDisk:夸克网盘: 夸克网盘下载<br/>NetDisk:微云: 微云下载<br/>NetDisk:微盘: 微盘下载<br/>NetDisk:百度网盘: 百度网盘下载<br/>NetDisk:纳米盘: 纳米盘下载<br/>NetDisk:酷盘: 酷盘下载<br/>NetDisk:金山快盘: 金山快盘下载<br/>NetDisk:阿里云盘: 阿里云盘下载<br/>NetShare: 网络共享渠道<br/>NewFile: 新入文件<br/>SoftMgr: 软件管理渠道<br/>SoftMgr:2345软件管家: 2345软件管家下载<br/>SoftMgr:360安全卫士: 360安全卫士下载<br/>SoftMgr:360驱动大师: 360驱动大师下载<br/>SoftMgr:91手机助手: 91手机助手下载<br/>SoftMgr:PP助手: PP助手下载<br/>SoftMgr:天极软件管家: 天极软件管家下载<br/>SoftMgr:微软电脑管家: 微软电脑管家下载<br/>SoftMgr:搜狗手机助手: 搜狗手机助手下载<br/>SoftMgr:爱思助手: 爱思助手下载<br/>SoftMgr:联想电脑管家: 联想电脑管家下载<br/>SoftMgr:腾讯电脑管家: 腾讯电脑管家下载<br/>SoftMgr:豌豆荚2: 豌豆荚2下载<br/>SoftMgr:软媒魔方软件管理: 软媒魔方软件管理下载<br/>SoftMgr:金山手机助手: 金山手机助手下载<br/>SoftMgr:金山毒霸: 金山毒霸下载<br/>SoftMgr:风灵软件管家: 风灵软件管家下载<br/>SoftMgr:驱动人生: 驱动人生下载<br/>SoftMgr:驱动人生软件管理: 驱动人生软件管理下载<br/>SoftMgr:驱动精灵: 驱动精灵下载<br/>TrustSource: 可信进程释放<br/>UnknownSource: 未知进程释放 |
| Parent.ScanAttr | string | 威胁鉴定 | Black: 恶意<br/>Safe: 安全<br/>Unknown: 未知<br/>Virus: 恶意<br/>White: 安全 |
| Parent.ThreadId | int | 线程ID |  |
| Parent.TrojanName | string | 病毒名 |  |
| Child | object | 目标节点 |  |
| Child.SubjectUserSid | string | 用户安全ID |  |
| Child.SubjectUserName | string | 帐户名称 |  |
| Child.SubjectDomainName | string | 账户域 |  |
| Child.SubjectLogonId | string | 登录ID |  |
| Child.PreviousTime | string | 上一时间 |  |
| Child.NewTime | string | 新时间 |  |
| Child.ElevatedToken | string | 提升的令牌 | 否: 否<br/>是: 是 |
| Child.ImpersonationLevel | string | 模拟级别 | 委派: 委派<br/>标识: 标识<br/>模拟: 模拟 |
| Child.RestrictedAdminMode | string | 受限管理员模式 | 否: 否<br/>是: 是 |
| Child.TargetUserSid | string | 目标安全ID |  |
| Child.TargetUserName | string | 目标帐户名称 |  |
| Child.TargetDomainName | string | 目标账户域 |  |
| Child.TargetLogonId | string | 目标登录ID |  |
| Child.TargetLinkedLogonId | string | 目标链接登录ID |  |
| Child.TargetOutboundUserName | string | 网络帐户名称 |  |
| Child.TargetOutboundDomainName | string | 网络帐户域 |  |
| Child.TransmittedServices | string | 传输服务 |  |
| Child.VirtualAccount | string | 虚拟帐户 | 否: 否<br/>是: 是 |
| Child.WorkstationName | string | 工作站名称 |  |
| Child.AccessList | string | 访问列表 |  |
| Child.AccessMask | string | 访问掩码 |  |
| Child.AccessReason | string | 访问检查结果 |  |
| Child.AccountExpires | string | 账户过期 |  |
| Child.AllowedToDelegateTo | string | 委派凭据的SPN 列表 |  |
| Child.AuditSourceName | string | 源名称 |  |
| Child.AuthenticationPackageName | string | 身份验证包 | Kerberos: Kerberos<br/>LM: LM<br/>Negotiate: Negotiate<br/>NTLM V1: NTLM V1<br/>NTLM V2: NTLM V2 |
| Child.ConfiguredNames | string | 配置名称 |  |
| Child.ClassId | string | 类ID |  |
| Child.ClassName | string | 类名 |  |
| Child.CompatibleIds | string | 兼容ID |  |
| Child.ClientMachine | string | 主机名 |  |
| Child.ClientMachineFQDN | string | 域名 |  |
| Child.ClientProcessCreationTime | string | 进程启动时间 |  |
| Child.CorrelationId | string | 绑定ID |  |
| Child.Commandline | string | 创建命令行 |  |
| Child.CreatedProcessCreationTime | string | 创建进程时间 |  |
| Child.DeviceClaims | string | 设备声明 |  |
| Child.DisabledPrivilegeList | string | 禁用权限列表 |  |
| Child.DisplayName | string | 显示名称 |  |
| Child.DeviceId | string | 设备ID |  |
| Child.DeviceDescription | string | 设备名称 |  |
| Child.EnabledPrivilegeList | string | 启用权限列表 |  |
| Child.EventSourceId | string | 事件源ID |  |
| Child.ErrorCode | string | 错误代码 |  |
| Child.FailureReason | string | 失败原因 |  |
| Child.GroupOperationId | string | 组操作ID |  |
| Child.HandleId | string | 句柄ID |  |
| Child.HomeDirectory | string | 主目录 |  |
| Child.HomePath | string | 主路径 |  |
| Child.IsLocal | bool | 是否本地 |  |
| Child.IpAddress | string | 源网络地址 |  |
| Child.IpPort | string | 源端口 |  |
| Child.KeyLength | string | 密钥长度 |  |
| Child.LogonGuid | string | 登录GUID |  |
| Child.LogonProcessName | string | 登录进程名称 |  |
| Child.LogonType | string | 登录类型 | 0: 系统启动<br/>10: 远程登录<br/>2: 交互式<br/>3: 网络<br/>4: 计划任务<br/>5: 服务 |
| Child.LogonHours | string | 登录限制时长 |  |
| Child.LocationInformation | string | 位置信息 |  |
| Child.NewSd | string | 新的安全描述符 |  |
| Child.MasterKeyId | string | 密钥标识符 |  |
| Child.NewUacValue | string | 新UAC值 |  |
| Child.NewRemark | string | 新注释值 |  |
| Child.NewMaxUsers | string | 新的用户数限制值 |  |
| Child.NewShareFlags | string | 新的脱机设置值 |  |
| Child.NamespaceName | string | 命名空间名称 |  |
| Child.ObjectServer | string | 对象服务器 |  |
| Child.ObjectType | string | 对象类型 |  |
| Child.ObjectName | string | 对象名称 |  |
| Child.OldSd | string | 原始安全描述 |  |
| Child.OldUacValue | string | 旧UAC值 |  |
| Child.OldRemark | string | 旧注释值 |  |
| Child.OldMaxUsers | string | 旧的用户数限制值 |  |
| Child.OldShareFlags | string | 旧的脱机设置值 |  |
| Child.Operation | string | 操作 |  |
| Child.OperationId | string | 操作ID |  |
| Child.PrivilegeList | string | 权限列表 |  |
| Child.Properties | string | 属性 |  |
| Child.ProfilePath | string | 配置文件路径 |  |
| Child.PasswordLastSet | string | 密码最后一个集 |  |
| Child.PrimaryGroupId | string | 主组ID |  |
| Child.ProfileChanged | string | 已更改配置文件 |  |
| Child.RestrictedSidCount | string | 受限SID 计数 |  |
| Child.RecoveryServer | string | 恢复服务器 |  |
| Child.RecoveryKeyId | string | 恢复密钥 ID |  |
| Child.RelativeTargetName | string | 相对目标名称 |  |
| Child.Status | string | 状态 |  |
| Child.SubStatus | string | 子状态 |  |
| Child.Service | string | 服务名称 |  |
| Child.SamAccountName | string | SAM帐户名称 |  |
| Child.ScriptPath | string | 脚本路径 |  |
| Child.SidHistory | string | SID历史记录 |  |
| Child.SettingType | string | 设置类型 |  |
| Child.SettingValue | string | 设置类型 |  |
| Child.SidList | string | 特殊组SID列表 |  |
| Child.ShareName | string | 共享名称 |  |
| Child.ShareLocalPath | string | 共享路径 |  |
| Child.SpnName | string | SPN名称 |  |
| Child.ServerNames | string | 服务器名称 |  |
| Child.TargetLogonGuid | string | 目标登录GUID |  |
| Child.TargetServerName | string | 目标服务器名称 |  |
| Child.TargetInfo | string | 目标信息 |  |
| Child.TransactionId | string | 事务ID |  |
| Child.TaskName | string | 任务名称 |  |
| Child.TaskContent | string | 任务内容 |  |
| Child.TaskContentNew | string | 任务新内容 |  |
| Child.TargetSid | string | 目标登录ID |  |
| Child.UserClaims | string | 用户声明 |  |
| Child.UserPrincipalName | string | 用户主体名称 |  |
| Child.UserWorkstations | string | 用户工作站 |  |
| Child.UserAccountControl | string | 用户帐户控件 |  |
| Child.UserParameters | string | 用户参数 |  |
| Child.User | string | 用户名 |  |
| Child.VendorIds | string | 供应商ID |  |
| Child.FilterType | string | Hook类型 |  |
| Child.ReturnValue | string | 注册结果 |  |
| Child.hmod | string | DLL句柄 |  |
| Child.pfnFilterProc | string | 过滤函数 |  |
| Child.pstrLib | string | 模块路径 |  |
| Child.ContentName | string | 脚本名称 |  |
| Child.ContentData | string | 脚本数据 |  |
| Child.ApiRet | int | 返回值 |  |
| Child.Privileges | string | 特权列表 |  |
| Child.Addr | int | 起始地址 |  |
| Child.Param1 | int | 参数1 |  |
| Child.Size | int | 地址大小 |  |
| Child.NewProtect | int | 新权限 | 0x1: 无权限<br/>0x10: 可执行<br/>0x100: 保护页面<br/>0x2: 只读<br/>0x20: 执行读<br/>0x200: 无缓存<br/>0x4: 只写<br/>0x40: 执行读写<br/>0x8: 只拷贝<br/>0x80: 执行写拷贝 |
| Child.OldProtect | int | 旧权限 | 0x1: 无权限<br/>0x10: 可执行<br/>0x100: 保护页面<br/>0x2: 只读<br/>0x20: 执行读<br/>0x200: 无缓存<br/>0x4: 只写<br/>0x40: 执行读写<br/>0x8: 只拷贝<br/>0x80: 执行写拷贝 |
| Child.Method | string | 请求方法 | CONNECT: CONNECT<br/>DELETE: DELETE<br/>GET: GET<br/>HEAD: HEAD<br/>OPTIONS: OPTIONS<br/>PATCH: PATCH<br/>POST: POST<br/>PUT: PUT<br/>TRACE: TRACE |
| Child.ProtoVersion | string | 协议版本 |  |
| Child.Referer | string | 来源 |  |
| Child.AcceptTypes | string | 接受类型 |  |
| Child.Flags | int | 选项标志 |  |
| Child.UserName | string | 用户名 |  |
| Child.Password | string | 密码 |  |
| Child.ProtoService | int | 访问类型 | 1: FTP<br/>2: GOPHER<br/>3: HTTP |
| Child.Header | string | 请求头 |  |
| Child.Agent | string | User-Agent |  |
| Child.AccessTypes | int | 接受类型 | 0: 注册表配置<br/>1: 直连网络<br/>2: 通过代理<br/>3: 无自动代理 |
| Child.Proxy | string | 代理服务 |  |
| Child.ProxyByPass | string | 免代理域名 |  |
| Child.EventBegin | int | 事件起始 |  |
| Child.EventEnd | int | 事件结束 |  |
| Child.Handle | int | 句柄 |  |
| Child.ContextFlags | int | 上下文类型 |  |
| Child.Eip | int | EIP寄存器 |  |
| Child.OldEip | int | EIP寄存器 |  |
| Child.BlobData | string | 二进制数据 |  |
| Child.FuncName | string | 函数名 |  |
| Child.ProtectType | int | 内存权限 | 0x1: 无权限<br/>0x10: 可执行<br/>0x100: 保护页面<br/>0x2: 只读<br/>0x20: 执行读<br/>0x200: 无缓存<br/>0x4: 只写<br/>0x40: 执行读写<br/>0x8: 只拷贝<br/>0x80: 执行写拷贝 |
| Child.AllocType | int | 分配类型 | 0x1000: 提交内存<br/>0x2000: 保留内存<br/>0x40000: 映射内存<br/>0x400000: 物理内存 |
| Child.Protocol | string | 协议类型 | tcp: tcp<br/>udp: udp |
| Child.SrcIp | string | 源IP（本机IP） |  |
| Child.SrcPort | int | 源端口（本机端口） |  |
| Child.DstIp | string | 目标IP（远程IP） |  |
| Child.DstPort | int | 目标端口（远程端口） |  |
| Child.Direct | int | 流量方向 | 1: 出站<br/>2: 入站 |
| Child.SendTotal | int | 发送总的字节数 |  |
| Child.RecvTotal | int | 收到总的字节数 |  |
| Child.Host | string | 域名 |  |
| Child.Url | string | URL |  |
| Child.FlowTags | string | 流数据标签 |  |
| Child.DnsAnswers | string | DNS应答IP |  |
| Child.IpIoc | string | IP威胁情报 | Black: 黑\(Black\)<br/>Gray: 灰\(Gray\)<br/>Unknown: 未知\(Unknown\)<br/>White: 安全\(White\) |
| Child.HostIoc | string | 域名威胁情报 | Black: 黑\(Black\)<br/>Gray: 灰\(Gray\)<br/>Unknown: 未知\(Unknown\)<br/>White: 安全\(White\) |
| Child.ServiceName | string | 服务名称 |  |
| Child.StartType | int | 启动类型 | 0: Boot启动<br/>1: System启动<br/>2: 自动启动<br/>3: 手动启动<br/>4: 禁止启动 |
| Child.TaskName | string | 任务名称 |  |
| Child.TaskArg | string | 任务参数 |  |
| Child.RemoteCallType | int | 远程调用类型 | 0x1: MMC20Application<br/>0x10: WMI<br/>0x2: InternetExplorer<br/>0x4: ShellWindows<br/>0x8: ShellBrowserWindows |
| Child.PrintType | int | 打印机类型 | 1: RpcAsyncAddPrinterDriver<br/>2: RpcAddPrinterDriverEx |
| Child.DocFileOpt | int | 勒索诱饵操作类型 | 0x10: 删除文件<br/>0x4: 重命名<br/>0x40: 文件大小改变<br/>0x8: 写文件<br/>0x80: 设置文件信息 |
| Child.PhishChain | string | 钓鱼链 |  |
| Child.ProcPid | int | 进程Pid |  |
| Child.ProcCmdline | string | 进程命令行 |  |
| Child.FileName | string | 文件名 |  |
| Child.FilePath | string | 文件路径 |  |
| Child.FileDriverType | string | 驱动器类型 | CDRom: CD光盘<br/>Fixed: 硬盘<br/>，NoRootDir: 非驱动<br/>Ramdisk: 内存磁盘<br/>Remote: 网络驱动器<br/>Removeable: 可移动介质<br/>Unknown: 未知 |
| Child.FileMd5 | string | 文件md5 |  |
| Child.CloudAttr | string | 云查属性 | Black: 黑\(Black\)<br/>Gray: 灰\(Gray\)<br/>Unknown: 未知\(Unknown\)<br/>White: 安全\(White\) |
| Child.FileSign | string | 文件签名 |  |
| Child.FileSignStatus | string | 文件签名状态 | Expired: 签名过期<br/>Invalid: 验证不通过<br/>Valid: 验证通过 |
| Child.FileSignWhite | int | 是否白签名 | 0: 不是<br/>1: 是 |
| Child.RegKeyPath | string | 注册表路径 |  |
| Child.RegValName | string | 注册表值名 |  |
| Child.RegValType | int | 注册表值类型 | 1: 字符串<br/>11: QWORD（64位整数）<br/>2: 可扩展字符串<br/>3: 二进制<br/>4: DWORD（32位整数）<br/>7: 多字符串 |
| Child.RegValData | string | 注册表值数据 |  |
| Child.RegOldValType | int | 注册表旧值类型 | 1: 字符串<br/>11: QWORD（64位整数）<br/>2: 可扩展字符串<br/>3: 二进制<br/>4: DWORD（32位整数）<br/>7: 多字符串 |
| Child.RegOldValData | string | 注册表旧值数据 |  |
| Child.RegGroupName | string | 注册表分组名称 | DOS虚拟机程序: DOS虚拟机程序<br/>IE临时文件夹: IE临时文件夹<br/>IE安全性设置: IE安全性设置<br/>IE插件扩展: IE插件扩展<br/>IE浏览器路径: IE浏览器路径<br/>IE源码查看器: IE源码查看器<br/>INI文件劫持: INI文件劫持<br/>IPSec策略设置: IPSec策略设置<br/>IP安全组策略: IP安全组策略<br/>SHELL名字空间: SHELL名字空间<br/>TCPIP网络设置: TCPIP网络设置<br/>URL前缀: URL前缀<br/>URL协议关联: URL协议关联<br/>Windows防火墙: Windows防火墙<br/>分层网络协议: 分层网络协议<br/>协议关联图标: 协议关联图标<br/>右键菜单: 右键菜单<br/>启动文件夹: 启动文件夹<br/>启动项: 启动项<br/>启动项登录脚本: 启动项登录脚本<br/>命令行劫持: 命令行劫持<br/>命令行工具: 命令行工具<br/>安全模式配置: 安全模式配置<br/>应用卸载设置: 应用卸载设置<br/>打印机支持程序: 打印机支持程序<br/>控制面板设置: 控制面板设置<br/>敏感启动项: 敏感启动项<br/>文件关联: 文件关联<br/>映像劫持: 映像劫持<br/>服务支持程序: 服务支持程序<br/>本地安全策略: 本地安全策略<br/>本地账户凭证: 本地账户凭证<br/>浏览器侧边栏: 浏览器侧边栏<br/>浏览器工具条: 浏览器工具条<br/>浏览器工具栏按钮: 浏览器工具栏按钮<br/>浏览器插件: 浏览器插件<br/>浏览器插件: 浏览器插件<br/>浏览器通信协议: 浏览器通信协议<br/>浏览器首页设置: 浏览器首页设置<br/>浏览器默认下载工具: 浏览器默认下载工具<br/>浏览器默认搜索引擎: 浏览器默认搜索引擎<br/>漏洞CLSID: 漏洞CLSID<br/>系统动态组件: 系统动态组件<br/>系统启动校验程序: 系统启动校验程序<br/>系统常用文件夹: 系统常用文件夹<br/>系统服务: 系统服务<br/>系统环境变量: 系统环境变量<br/>系统登录初始化程序: 系统登录初始化程序<br/>系统登录界面: 系统登录界面<br/>系统登录管理: 系统登录管理<br/>系统登录脚本: 系统登录脚本<br/>系统登陆管理项: 系统登陆管理项<br/>系统证书: 系统证书<br/>系统配置策略: 系统配置策略<br/>组策略启动项: 组策略启动项<br/>组策略脚本启动项: 组策略脚本启动项<br/>网络远程调用协议: 网络远程调用协议<br/>老版操作系统启动项: 老版操作系统启动项<br/>输入法设置: 输入法设置<br/>进程预加载项: 进程预加载项<br/>远程桌面服务: 远程桌面服务<br/>隐藏文件夹选项: 隐藏文件夹选项<br/>隐藏桌面图标设置: 隐藏桌面图标设置<br/>默认任务管理器: 默认任务管理器<br/>默认加载库: 默认加载库<br/>默认字库设置: 默认字库设置<br/>默认屏保程序: 默认屏保程序<br/>默认浏览器设置: 默认浏览器设置<br/>默认输入法设置: 默认输入法设置 |
| Child.Type | string | 节点类型 | ApiCall: 系統API<br/>File: 文件<br/>FileStatics: 文件统计<br/>Log: 日志<br/>Network: 网络<br/>Pipe: 管道<br/>Pipe: 管道<br/>Proc: 进程<br/>Reg: 注册表<br/>Script: 脚本 |
| Child.CallStack | string | 调用堆栈 |  |
| Child.ThreadId | int | 线程ID |  |
| Child.ProcGuid | string | 进程唯一ID |  |
| Child.ProcIntegrity | int | 进程完整性级别 | 1: 不可信<br/>2: 低<br/>3: 中<br/>4: 中+<br/>5: 高<br/>6: 系统<br/>7: 保护进程 |
| Child.ProcElevationType | int | 进程提权类型 | 1: UAC关闭<br/>2: UAC提权<br/>3: UAC限制权限 |
| Child.ProcExited | bool | 进程退出标志 |  |
| Child.ProcArch | string | 进程架构 | x64: x64<br/>x86: x86 |
| Child.ProcUserName | string | 进程用户名 |  |
| Child.ProcDomainName | string | 进程用户域名 |  |
| Child.ProcCurDir | string | 进程当前目录 |  |
| Child.ProcDesktop | string | 进程桌面名称 |  |
| Child.ProcTrust | string | 进程可信 | NoTrust: 不可信<br/>Trust: 可信 |
| Child.ProcChainTrust | string | 进程链可信 | NoTrust: 不可信<br/>Trust: 可信 |
| Child.ProcChainInfo | string | 进程链详情 |  |
| Child.FileStream | string | 文件流名称 |  |
| Child.FileFormat | string | 文件类型 | DLL: 动态链接库<br/>EXE: 可执行EXE<br/>NPE: 非PE<br/>SYS: 驱动 |
| Child.FileMd5Type | string | 文件md5类型 | FullMd5: 全文<br/>HalfMd5: 半文 |
| Child.FileSize | int | 文件大小 |  |
| Child.FileIssuer | string | 签名颁发机构 |  |
| Child.FileCompany | string | 文件公司名 |  |
| Child.FileDesc | string | 文件描述 |  |
| Child.FileVersion | string | 文件版本 |  |
| Child.FileOriginalName | string | 原始文件名 |  |
| Child.FileProductName | string | 文件产品名 |  |
| Child.FileProductVer | string | 文件产品版本号 |  |
| Child.FileLegalMark | string | 文件产品商标 |  |
| Child.FileCopyright | string | 文件版权 |  |
| Child.FileModifyTime | int | 文件修改时间 |  |
| Child.FileAccessTime | int | 文件访问时间 |  |
| Child.FileCreateTime | int | 文件创建时间 |  |
| Child.FileTags | string | 文件标签 | Browser: 浏览器渠道<br/>Browser:114高速浏览器: 114高速浏览器下载<br/>Browser:115极速浏览器: 115极速浏览器下载<br/>Browser:115浏览器: 115浏览器下载<br/>Browser:2345加速浏览器: 2345加速浏览器下载<br/>Browser:2345智能浏览器: 2345智能浏览器下载<br/>Browser:360安全浏览器: 360安全浏览器下载<br/>Browser:360极速浏览器: 360极速浏览器下载<br/>Browser:Edge浏览器: Edge浏览器下载<br/>Browser:GreenBrowser: GreenBrowser下载<br/>Browser:GT游戏浏览器: GT游戏浏览器下载<br/>Browser:hao123桔子浏览器: hao123桔子浏览器下载<br/>Browser:IE浏览器: IE浏览器下载<br/>Browser:iQ浏览器: iQ浏览器下载<br/>Browser:KR浏览器: KR浏览器下载<br/>Browser:MyIE浏览器: MyIE浏览器下载<br/>Browser:Opera: Opera下载<br/>Browser:QQ浏览器: QQ浏览器下载<br/>Browser:Safari浏览器: Safari浏览器下载<br/>Browser:Spartan浏览器: Spartan浏览器下载<br/>Browser:TT浏览器: TT浏览器下载<br/>Browser:UC浏览器: UC浏览器下载<br/>Browser:YY浏览器: YY浏览器下载<br/>Browser:世界之窗浏览器: 世界之窗浏览器下载<br/>Browser:世界之窗浏览器极速版: 世界之窗浏览器极速版下载<br/>Browser:傲游浏览器: 傲游浏览器下载<br/>Browser:搜狗浏览器: 搜狗浏览器下载<br/>Browser:淘宝浏览器: 淘宝浏览器下载<br/>Browser:火狐浏览器: 火狐浏览器下载<br/>Browser:猎豹浏览器: 猎豹浏览器下载<br/>Browser:瑞影浏览器: 瑞影浏览器下载<br/>Browser:百度浏览器: 百度浏览器下载<br/>Browser:百度浏览器hao123专版: 百度浏览器hao123专版下载<br/>Browser:糖果浏览器: 糖果浏览器下载<br/>Browser:花儿世界浏览器: 花儿世界浏览器下载<br/>Browser:谷歌浏览器: 谷歌浏览器下载<br/>Browser:超速浏览器: 超速浏览器下载<br/>Browser:闪游浏览器: 闪游浏览器下载<br/>Browser:随E浏览器: 随E浏览器下载<br/>Browser:青猴浏览器: 青猴浏览器下载<br/>Downloader: 下载器渠道<br/>Downloader:BitComet: BitComet下载<br/>Downloader:IDMan: IDMan下载<br/>Downloader:QQ旋风: QQ旋风下载<br/>Downloader:QQ旋风下载助手: QQ旋风下载助手下载<br/>Downloader:RaySource: RaySource下载<br/>Downloader:旋风高速下载引擎: 旋风高速下载<br/>Downloader:比特彗星: 比特彗星下载<br/>Downloader:电驴: 电驴下载<br/>Downloader:百度下载助手: 百度下载助手下载<br/>Downloader:百度云管家: 百度云管家下载<br/>Downloader:网际快车: 网际快车下载<br/>Downloader:网页迅雷: 网页迅雷下载<br/>Downloader:迅雷: 迅雷下载<br/>Downloader:迅雷云加速: 迅雷云加速下载<br/>Downloader:迅雷精简版: 迅雷精简版下载<br/>Downloader:迅雷迷你版: 迅雷迷你版下载<br/>Downloader:迷你快车: 迷你快车下载<br/>Downloader:迷你电驴: 迷你电驴下载<br/>Downloader:飞鸟下载器: 飞鸟下载器下载<br/>IM: IM渠道<br/>IM:FSLink: FSLink下载<br/>IM:MSN: MSN下载<br/>IM:Skype: Skype下载<br/>IM:YY语音: YY语音下载<br/>IM:京东咚咚: 京东咚咚下载<br/>IM:企业微信: 企业微信下载<br/>IM:微信: 微信下载<br/>IM:易信: 易信下载<br/>IM:润工作: 润工作下载<br/>IM:环信: 环信下载<br/>IM:百度Hi: 百度Hi下载<br/>IM:百度Hi: 百度Hi下载<br/>IM:网易CC语音: 网易CC语音下载<br/>IM:网易云信: 网易云信下载<br/>IM:腾讯QQ: 腾讯QQ下载<br/>IM:腾讯TM: 腾讯TM下载<br/>IM:腾讯通\(RTX\): 腾讯通\(RTX\)下载<br/>IM:钉钉: 钉钉下载<br/>IM:阿里旺旺: 阿里旺旺下载<br/>IM:飞书: 飞书下载<br/>IM:飞信: 飞信下载<br/>Mail: 邮箱渠道<br/>Mail:139邮箱: 139邮箱下载<br/>Mail:Foxmail: Foxmail下载<br/>Mail:PP助手: OutLook下载<br/>Mail:新浪邮箱: 新浪邮箱下载<br/>Mail:网易邮箱: 网易邮箱下载<br/>Mail:阿里邮箱: 阿里邮箱下载<br/>NetDisk: 网盘渠道<br/>NetDisk:115网盘: 115网盘下载<br/>NetDisk:360云盘: 360云盘下载<br/>NetDisk:360网盘: 360网盘下载<br/>NetDisk:优蛋: 优蛋下载<br/>NetDisk:华为网盘: 华为网盘下载<br/>NetDisk:坚果云: 坚果云下载<br/>NetDisk:城通网盘: 城通网盘下载<br/>NetDisk:天翼云盘: 天翼云盘下载<br/>NetDisk:夸克网盘: 夸克网盘下载<br/>NetDisk:微云: 微云下载<br/>NetDisk:微盘: 微盘下载<br/>NetDisk:百度网盘: 百度网盘下载<br/>NetDisk:纳米盘: 纳米盘下载<br/>NetDisk:酷盘: 酷盘下载<br/>NetDisk:金山快盘: 金山快盘下载<br/>NetDisk:阿里云盘: 阿里云盘下载<br/>NetShare: 网络共享渠道<br/>NewFile: 新入文件<br/>SoftMgr: 软件管理渠道<br/>SoftMgr:2345软件管家: 2345软件管家下载<br/>SoftMgr:360安全卫士: 360安全卫士下载<br/>SoftMgr:360驱动大师: 360驱动大师下载<br/>SoftMgr:91手机助手: 91手机助手下载<br/>SoftMgr:PP助手: PP助手下载<br/>SoftMgr:天极软件管家: 天极软件管家下载<br/>SoftMgr:微软电脑管家: 微软电脑管家下载<br/>SoftMgr:搜狗手机助手: 搜狗手机助手下载<br/>SoftMgr:爱思助手: 爱思助手下载<br/>SoftMgr:联想电脑管家: 联想电脑管家下载<br/>SoftMgr:腾讯电脑管家: 腾讯电脑管家下载<br/>SoftMgr:豌豆荚2: 豌豆荚2下载<br/>SoftMgr:软媒魔方软件管理: 软媒魔方软件管理下载<br/>SoftMgr:金山手机助手: 金山手机助手下载<br/>SoftMgr:金山毒霸: 金山毒霸下载<br/>SoftMgr:风灵软件管家: 风灵软件管家下载<br/>SoftMgr:驱动人生: 驱动人生下载<br/>SoftMgr:驱动人生软件管理: 驱动人生软件管理下载<br/>SoftMgr:驱动精灵: 驱动精灵下载<br/>TrustSource: 可信进程释放<br/>UnknownSource: 未知进程释放 |
| Child.ScanAttr | string | 威胁鉴定 | Black: 恶意<br/>Safe: 安全<br/>Unknown: 未知<br/>Virus: 恶意<br/>White: 安全 |
| Child.FileMappingType | mask | 映射方式 | 0x04: 读写<br/>0x08: 写复制<br/>0x10: 执行<br/>0x20: 执行读<br/>0x40: 执行读写<br/>0x80: 执行写复制 |
| Child.FileCreateOpName | string | 打开方式 | CREATE: 新建文件<br/>OPEN: 打开文件<br/>OVERWRITE: 覆盖写文件 |
| Child.FileCreateDisposition | int | 打开位置 | 1: 新建<br/>2: 新建覆盖<br/>3: 打开新建<br/>4: 打开存在<br/>5: 打开清空 |
| Child.FileCreateDesiredAccess | mask | 打开权限 | 0x10000000: 所有权限<br/>0x20000000: 执行权限<br/>0x40000000: 写权限<br/>0x80000000: 读权限 |
| Child.FileCreateShareAccess | mask | 共享权限 | 0x1: 共享读<br/>0x2: 共享写<br/>0x4: 共享删除 |
| Child.FileCreateFileAttributes | mask | 设置属性 | 0x1: 只读<br/>0x100: 临时<br/>0x2: 隐藏<br/>0x4: 系统<br/>0x40: 设备<br/>0x80: 常规 |
| Child.FileTotalWrite | int | 文件写入大小 |  |
| Child.FileTotalRead | int | 文件读取大小 |  |
| Child.OldFilePath | string | 源文件路径 |  |
| Child.OldFileTags | string | 源文件标签 | Browser: 浏览器渠道<br/>Browser:114高速浏览器: 114高速浏览器下载<br/>Browser:115极速浏览器: 115极速浏览器下载<br/>Browser:115浏览器: 115浏览器下载<br/>Browser:2345加速浏览器: 2345加速浏览器下载<br/>Browser:2345智能浏览器: 2345智能浏览器下载<br/>Browser:360安全浏览器: 360安全浏览器下载<br/>Browser:360极速浏览器: 360极速浏览器下载<br/>Browser:Edge浏览器: Edge浏览器下载<br/>Browser:GreenBrowser: GreenBrowser下载<br/>Browser:GT游戏浏览器: GT游戏浏览器下载<br/>Browser:hao123桔子浏览器: hao123桔子浏览器下载<br/>Browser:IE浏览器: IE浏览器下载<br/>Browser:iQ浏览器: iQ浏览器下载<br/>Browser:KR浏览器: KR浏览器下载<br/>Browser:MyIE浏览器: MyIE浏览器下载<br/>Browser:Opera: Opera下载<br/>Browser:QQ浏览器: QQ浏览器下载<br/>Browser:Safari浏览器: Safari浏览器下载<br/>Browser:Spartan浏览器: Spartan浏览器下载<br/>Browser:TT浏览器: TT浏览器下载<br/>Browser:UC浏览器: UC浏览器下载<br/>Browser:YY浏览器: YY浏览器下载<br/>Browser:世界之窗浏览器: 世界之窗浏览器下载<br/>Browser:世界之窗浏览器极速版: 世界之窗浏览器极速版下载<br/>Browser:傲游浏览器: 傲游浏览器下载<br/>Browser:搜狗浏览器: 搜狗浏览器下载<br/>Browser:淘宝浏览器: 淘宝浏览器下载<br/>Browser:火狐浏览器: 火狐浏览器下载<br/>Browser:猎豹浏览器: 猎豹浏览器下载<br/>Browser:瑞影浏览器: 瑞影浏览器下载<br/>Browser:百度浏览器: 百度浏览器下载<br/>Browser:百度浏览器hao123专版: 百度浏览器hao123专版下载<br/>Browser:糖果浏览器: 糖果浏览器下载<br/>Browser:花儿世界浏览器: 花儿世界浏览器下载<br/>Browser:谷歌浏览器: 谷歌浏览器下载<br/>Browser:超速浏览器: 超速浏览器下载<br/>Browser:闪游浏览器: 闪游浏览器下载<br/>Browser:随E浏览器: 随E浏览器下载<br/>Browser:青猴浏览器: 青猴浏览器下载<br/>Downloader: 下载器渠道<br/>Downloader:BitComet: BitComet下载<br/>Downloader:IDMan: IDMan下载<br/>Downloader:QQ旋风: QQ旋风下载<br/>Downloader:QQ旋风下载助手: QQ旋风下载助手下载<br/>Downloader:RaySource: RaySource下载<br/>Downloader:旋风高速下载引擎: 旋风高速下载<br/>Downloader:比特彗星: 比特彗星下载<br/>Downloader:电驴: 电驴下载<br/>Downloader:百度下载助手: 百度下载助手下载<br/>Downloader:百度云管家: 百度云管家下载<br/>Downloader:网际快车: 网际快车下载<br/>Downloader:网页迅雷: 网页迅雷下载<br/>Downloader:迅雷: 迅雷下载<br/>Downloader:迅雷云加速: 迅雷云加速下载<br/>Downloader:迅雷精简版: 迅雷精简版下载<br/>Downloader:迅雷迷你版: 迅雷迷你版下载<br/>Downloader:迷你快车: 迷你快车下载<br/>Downloader:迷你电驴: 迷你电驴下载<br/>Downloader:飞鸟下载器: 飞鸟下载器下载<br/>IM: IM渠道<br/>IM:FSLink: FSLink下载<br/>IM:MSN: MSN下载<br/>IM:Skype: Skype下载<br/>IM:YY语音: YY语音下载<br/>IM:京东咚咚: 京东咚咚下载<br/>IM:企业微信: 企业微信下载<br/>IM:微信: 微信下载<br/>IM:易信: 易信下载<br/>IM:润工作: 润工作下载<br/>IM:环信: 环信下载<br/>IM:百度Hi: 百度Hi下载<br/>IM:百度Hi: 百度Hi下载<br/>IM:网易CC语音: 网易CC语音下载<br/>IM:网易云信: 网易云信下载<br/>IM:腾讯QQ: 腾讯QQ下载<br/>IM:腾讯TM: 腾讯TM下载<br/>IM:腾讯通\(RTX\): 腾讯通\(RTX\)下载<br/>IM:钉钉: 钉钉下载<br/>IM:阿里旺旺: 阿里旺旺下载<br/>IM:飞书: 飞书下载<br/>IM:飞信: 飞信下载<br/>Mail: 邮箱渠道<br/>Mail:139邮箱: 139邮箱下载<br/>Mail:Foxmail: Foxmail下载<br/>Mail:PP助手: OutLook下载<br/>Mail:新浪邮箱: 新浪邮箱下载<br/>Mail:网易邮箱: 网易邮箱下载<br/>Mail:阿里邮箱: 阿里邮箱下载<br/>NetDisk: 网盘渠道<br/>NetDisk:115网盘: 115网盘下载<br/>NetDisk:360云盘: 360云盘下载<br/>NetDisk:360网盘: 360网盘下载<br/>NetDisk:优蛋: 优蛋下载<br/>NetDisk:华为网盘: 华为网盘下载<br/>NetDisk:坚果云: 坚果云下载<br/>NetDisk:城通网盘: 城通网盘下载<br/>NetDisk:天翼云盘: 天翼云盘下载<br/>NetDisk:夸克网盘: 夸克网盘下载<br/>NetDisk:微云: 微云下载<br/>NetDisk:微盘: 微盘下载<br/>NetDisk:百度网盘: 百度网盘下载<br/>NetDisk:纳米盘: 纳米盘下载<br/>NetDisk:酷盘: 酷盘下载<br/>NetDisk:金山快盘: 金山快盘下载<br/>NetDisk:阿里云盘: 阿里云盘下载<br/>NetShare: 网络共享渠道<br/>NewFile: 新入文件<br/>SoftMgr: 软件管理渠道<br/>SoftMgr:2345软件管家: 2345软件管家下载<br/>SoftMgr:360安全卫士: 360安全卫士下载<br/>SoftMgr:360驱动大师: 360驱动大师下载<br/>SoftMgr:91手机助手: 91手机助手下载<br/>SoftMgr:PP助手: PP助手下载<br/>SoftMgr:天极软件管家: 天极软件管家下载<br/>SoftMgr:微软电脑管家: 微软电脑管家下载<br/>SoftMgr:搜狗手机助手: 搜狗手机助手下载<br/>SoftMgr:爱思助手: 爱思助手下载<br/>SoftMgr:联想电脑管家: 联想电脑管家下载<br/>SoftMgr:腾讯电脑管家: 腾讯电脑管家下载<br/>SoftMgr:豌豆荚2: 豌豆荚2下载<br/>SoftMgr:软媒魔方软件管理: 软媒魔方软件管理下载<br/>SoftMgr:金山手机助手: 金山手机助手下载<br/>SoftMgr:金山毒霸: 金山毒霸下载<br/>SoftMgr:风灵软件管家: 风灵软件管家下载<br/>SoftMgr:驱动人生: 驱动人生下载<br/>SoftMgr:驱动人生软件管理: 驱动人生软件管理下载<br/>SoftMgr:驱动精灵: 驱动精灵下载<br/>TrustSource: 可信进程释放<br/>UnknownSource: 未知进程释放 |
| Child.FileSecurityAttr | mask | 文件安全属性 | 0x1: 拥有者安全信息<br/>0x10: LABEL安全信息<br/>0x100: 备份安全信息<br/>0x10000000: 未保护的SACL安全信息<br/>0x2: 组安全信息<br/>0x20: 属性安全信息<br/>0x20000000: 未保护的DACL安全信息<br/>0x4: DACL安全信息<br/>0x40: 范围安全信息<br/>0x40000000: 保护的SACL安全信息<br/>0x8: SACL安全信息<br/>0x80: 进程信任LABEL安全信息<br/>0x80000000: 保护的DACL安全信息 |
| Child.FileAttr | mask | 文件属性 | 0x2: 隐藏 |
| Child.ModifyCreateTime | mask | 修改创建时间 |  |
| Child.SetBasicOp | mask | 设置类型 | 0x1: 设置属性<br/>0x2: 修改创建时间 |
| Child.TrojanName | string | 病毒名 |  |
| Child.ModuleSize | int | 模块大小 |  |
| Child.ModuleBase | int | 模块起始地址 |  |
| Child.Cx | int | 坐标X |  |
| Child.Cy | int | 坐标Y |  |
| Child.WindowName | string | 窗口名 |  |
| Child.ClassName | string | 类名 |  |
| Child.AppVersion | int | 应用版本号 |  |
| Child.PipeOpName | string | 管道操作名称 | CREATE: 创建管道<br/>OPEN: 打开管道 |
| Child.PipeName | string | 管道名 |  |
| Child.RemoteThreadOpName | string | 线程操作名 |  |
| Child.ThreadStartAddr | int | 线程起始地址 |  |
| Child.HandleObjectOpName | string | 句柄操作名称 |  |
| Child.HandleAccessMask | int | 句柄访问权限 | 0x1: 结束进程<br/>0x10: 虚拟内存读<br/>0x100: 设置配额<br/>0x2: 创建线程<br/>0x20: 虚拟内存写<br/>0x4: 设置会话ID<br/>0x8: 虚拟内存操作<br/>0x80: 创建进程 |
| Child.DirPath | string | 目录路径 |  |
| Child.QueryClass | int | 信息类别 | 1: 目录信息<br/>2: 完整目录信息<br/>3: 额外目录信息<br/>4: 基础信息<br/>5: 标准信息 |
| Child.LnkPath | string | 快捷方式路径 |  |
| Child.ScriptFileName | string | 脚本名 |  |
| Child.ScriptFilePath | string | 脚本路径 |  |
| Child.ScriptFileMd5 | string | 脚本MD5 |  |
| Child.ScriptFileMd5Type | string | 脚本md5类型 | FullMd5: 全文<br/>HalfMd5: 半文 |
| Child.ScriptContent | string | 脚本内容 |  |
| Child.MailSubject | string | 邮件标题 |  |
| Child.Links | string | 邮件链接 |  |
| Child.Attachment | string | 邮件附件 |  |
| Child.FileStElapsedTime | int | 统计时长 |  |
| Child.FileStEnumDirCnt | int | 枚举目录数 |  |
| Child.FileStWriteDirCnt | int | 写入包含目录数 |  |
| Child.FileStWriteFileCnt | int | 写入文件数 |  |
| Child.FileStWriteExtCnt | int | 写入文件后缀数 |  |
| Child.FileSWriteSize | int | 写入大小 |  |
| Child.FileSWriteSpeed | int | 写入速度 |  |
| Child.FileStRenameDirCnt | int | 重命名包含目录数 |  |
| Child.FileStRenameFileCnt | int | 重命名文件数 |  |
| Child.FileStRenameExtCnt | int | 重命名文件后缀数 |  |
| Child.FileStRenameSrcExtCnt | int | 重命名文件源后缀数 |  |
| Child.FileStDeleteDirCnt | int | 删除包含目录数 |  |
| Child.FileStDeleteFileCnt | int | 删除文件数 |  |
| Child.FileStDeleteExtCnt | int | 删除文件后缀数 |  |
| Child.FileStExtWriteDirCnt | int | 后缀包含写入目录数 |  |
| Child.FileStExtWriteFileCnt | int | 后缀包含写入文件数 |  |
| Child.FileStExtWriteSize | int | 后缀包含写入文件大小 |  |
| Child.FileStExtDeleteDirCnt | int | 后缀包含删除目录数 |  |
| Child.FileStExtDeleteFileCnt | int | 后缀包含删除文件数 |  |
| Child.FileStExtRenameDirCnt | int | 后缀包含重命名目录数 |  |
| Child.FileStExtRenameFileCnt | int | 后缀包含重命名文件数 |  |
| Child.FileStExtRenameSrcExtCnt | int | 后缀包含重命名源后缀数 |  |
| Child.FileStExtName | string | 统计后缀名 |  |
| Child.VulId | int | 漏洞Id |  |
| Child.RemoteInjectEvent | string | 注入事件名称 |  |
| Child.RemoteProcPid | int | 远程进程Pid |  |
| Child.RemoteProcGuid | string | 远程进程唯一ID |  |
| Child.RemoteProcCmdline | string | 远程进程命令行 |  |
| Child.RemoteProcTid | int | 远程线程ID |  |
| Child.RemoteFileName | string | 远程进程名 |  |
| Child.RemoteFilePath | string | 远程进程路径 |  |
| Child.RemoteFileMd5 | string | 远程进程md5 |  |
| Child.RemoteFileMd5Type | string | 远程进程md5类型 | FullMd5: 全文<br/>HalfMd5: 半文 |
| Child.RemoteThreadId | int | 注入线程ID |  |
| Child.RemoteModuleName | string | 注入模块名 |  |
| Child.RemoteModulePath | string | 注入模块路径 |  |
| Child.RemoteModuleMd5 | string | 注入模块md5 |  |
| Child.RemoteModuleMd5Type | string | 注入模块md5类型 | FullMd5: 全文<br/>HalfMd5: 半文 |
| Child.RemoteModuleSize | int | 注入模块大小 |  |
| Child.RemoteModuleBase | int | 注入模块起始地址 |  |
| Common | object | 基础信息 |  |
| Common.EventId | int | 事件自增ID |  |
| Common.EventUUId | string | 事件唯一ID |  |
| Common.SessionId | int | 客户端启动号 |  |
| Common.KernelId | int | 内核事件ID |  |
| Common.Source | string | 事件来源 |  |
| Common.EventTime | int | 事件采集时间 |  |
| Common.AuthId | int | iOA授权ID |  |
| Common.Uid | int | iOA登录用户ID |  |
| Common.UserName | string | 企业账户 |  |
| Common.LoginStatus | int | 登录状态 | 1: 登录<br/>2: 未登录 |
| Common.Mid | string | 唯一标识码 |  |
| Common.Guid | string | GuidEx |  |
| Common.ClientVer | string | 客户端版本号 |  |
| Common.DeviceGroup | string | 终端分组信息 |  |
| Common.MonitorName | string | 监控名称 |  |
| Common.ReportId | int | 数据上报ID |  |
| Environment | object | 系统环境信息 |  |
| Environment.OsBit | string | 系统位数 | 32: 32位<br/>64: 64位 |
| Environment.OsVersion | string | 系统版本 | Win10: Win10<br/>Win11: Win11<br/>Win2000: Win2000<br/>Win2003: Win2003<br/>Win7: Win7<br/>Win8: Win8<br/>WinFuture: WinFuture<br/>WinVista: WinVista<br/>WinXP: WinXP |
| Environment.OsBuild | int | 系统build号 |  |
| Environment.OsProduectDesc | string | 系统版本描述 |  |
| Environment.OsUserName | string | 系统登录用户名 |  |
| Environment.SysStartTimes | int | 系统启动时间 |  |
| Environment.HostName | string | 主机名称 |  |
| Environment.ExportIp | string | 出口IP |  |
| Environment.MacAddr | string | MAC地址 |  |
| Environment.DomainName | string | 域 |  |
| Environment.OsType | string | 系统类型 | Linux: Linux<br/>macOS: macOS<br/>Windows: Windows |
| Alert | object | 告警字段 |  |
| Alert.RuleId | int | 命中的规则ID |  |
| Alert.RuleName | string | 命中的规则名称 |  |
| Alert.RuleNature | string | 命中的规则特性 |  |
| Alert.EventUuid | string | 告警去重ID |  |
| Alert.FixResult | string | 处置结果 |  |
| Alert.FixAction | string | 处置动作 |  |
| Alert.FixType | string | 处置方式 |  |
| Alert.UserOpt | string | 用户选择 |  |
| Alert.AlertSource | string | 告警来源 |  |
| Alert.BlockType | string | 拦截方式 |  |
| Alert.CloudRuleId | int | 云规则Id |  |
| Alert.CloudTitle | string | 云规则标题 |  |
| Alert.CloudEngineName | string | 云判定引擎 |  |
| Alert.IOCInfo | string | Ioc基本信息 |  |
| Alert.ExplainTags | string | 家族信息 |  |
| Alert.Whois | string | 域名信息 |  |

##### 采集日志动作类型取值范围

| 唯一Key | 说明 |
| :--- | :--- |
| Proc | 进程 |
| File | 文件 |
| Module | 加载模块 |
| Reg | 注册表 |
| Network | 网络 |
| WinEventLog | 系统日志 |
| InjectHook | 系统API |
| Script | 脚本文档 |
| LeftMove | 横向移动 |
| Ransomware | 勒索攻击 |
| Phishing | 钓鱼攻击 |
| Assoc | 动作关联 |

##### 采集日志子动作名称取值范围

| 所属动作 | 唯一Key | 说明 |
| :--- | :--- | :--- |
| Assoc | FileToProc | 文件关联进程 |
| Assoc | InjectPayloadToFile | 注入模块文件关联 |
| Assoc | DefRemoteInject | 未知注入动作关联 |
| Assoc | ApcInject | APC注入动作关联 |
| Assoc | LnkToTarget | 快捷方式关联 |
| Assoc | FileToExplorerCopy | 桌面拷贝关联 |
| Assoc | FileToRundll32 | Rundll32执行关联 |
| Assoc | ScriptToHost | 脚本执行进程关联 |
| Assoc | FileRenameSource | 重命名源文件关联 |
| Assoc | SrcToMove | 文件移动关联 |
| Assoc | SrcToCopy | 文件拷贝关联 |
| Assoc | SrcToRename | 文件重命名关联 |
| Assoc | ArchiveToFile | 压缩包释放关联 |
| Assoc | RegToFile | 注册表值解析关联 |
| Assoc | RemoteThreadInject | 远程线程注入动作关联 |
| File | FileWriteClose | 文件写关闭 |
| File | FileRename | 文件重命名 |
| File | FileRead | 文件读 |
| File | FileReadDir | 枚举目录 |
| File | FileMapping | 文件映射 |
| File | FileCreate | 文件打开 |
| File | FileDelete | 文件删除 |
| File | NamedPipe | 命名管道事件 |
| File | FileStatics | 文件操作统计 |
| File | FileSetBasicInfo | 文件设置基本信息 |
| File | FileSetSecurity | 文件设置安全属性 |
| InjectHook | GetKeyState | 获取虚拟按键状态 |
| InjectHook | CredUnPackAuthenticationBufferW | 解析身份验证缓冲区 |
| InjectHook | SspiPrepareForCredRead | 准备加密凭据读取 |
| InjectHook | VaultEnumerateItems | 枚举账号凭据（未公开） |
| InjectHook | SpGetCredentials | 获取账户凭据（未公开） |
| InjectHook | AcquireCredentialsHandleW | 获取加密组件句柄 |
| InjectHook | NetUserEnum | 枚举服务器账号 |
| InjectHook | NetUserGetGroups | 获取账户全局组 |
| InjectHook | NetUserGetLocalGroups | 获取账号本地组 |
| InjectHook | LsaEnumerateLogonSessions | 枚举登录会话 |
| InjectHook | LsaGetLogonSessionData | 获取登录会话信息 |
| InjectHook | LsaQueryForestTrustInformation | 获取林信任信息 |
| InjectHook | WNetAddConnection2W | 本地设备映射网络资源2 |
| InjectHook | WNetAddConnectionW | 本地设备映射到网络资源 |
| InjectHook | DsEnumerateDomainTrustsW | 枚举信任域信息 |
| InjectHook | DsGetDcNameW | 获取域控制器名称 |
| InjectHook | NetGroupEnum | 枚举服务器账户组 |
| InjectHook | NetLocalGroupEnum | 枚举服务器本地组账户组 |
| InjectHook | NetShareCheck | 检查服务器共享资源 |
| InjectHook | NetShareEnum | 枚举服务器共享资源 |
| InjectHook | NetShareGetInfo | 获取服务器指定资源 |
| InjectHook | HttpOpenRequestW | 打开Http请求 |
| InjectHook | InternetConnectW | WinINet连接 |
| InjectHook | InternetOpenUrlW | WinINet打开Url |
| InjectHook | InternetOpenW | 初始化WinINet |
| InjectHook | CreateToolhelp32Snapshot | 创建进程快照 |
| InjectHook | Process32FirstW | 遍历进程快照 |
| InjectHook | EnumProcess | 枚举进程Pid |
| InjectHook | OpenFileMappingW | 打开文件映射 |
| InjectHook | FindFirstFileW | 遍历文件 |
| InjectHook | FindFirstVolumeMountPointW | 枚举指定卷挂载目录 |
| InjectHook | FindFirstVolumeW | 枚举计算机卷 |
| InjectHook | SHFileOperationW | 文件操作 |
| InjectHook | IFileOperation\_RenameItem | 重命名文件 |
| InjectHook | IFileOperation\_RenameItems | 批量重命名文件 |
| InjectHook | IFileOperation\_MoveItems | 批量移动文件 |
| InjectHook | IFileOperation\_CopyItems | 批量拷贝文件 |
| InjectHook | IFileOperation\_DeleteItems | 批量删除文件 |
| InjectHook | CopyFileExW | 拷贝文件 |
| InjectHook | MoveFileExW | 移动文件 |
| InjectHook | NetWkstaGetInfo | 获取工作站配置 |
| InjectHook | GetCurrentHwProfileW | 检索硬件配置 |
| InjectHook | GetIpNetTable | 获取IPv4映射表 |
| InjectHook | GetIpNetTable2 | 获取IPv4映射表2 |
| InjectHook | GetComputerNameExW | 获取计算机名Ex |
| InjectHook | GetComputerNameW | 获取计算机名 |
| InjectHook | GetDiskFreeSpaceExW | 获取磁盘剩余空间Ex |
| InjectHook | GetDiskFreeSpaceW | 获取磁盘剩余空间 |
| InjectHook | GetLogicalProcessorInformationEx | 获取逻辑处理器Ex |
| InjectHook | GetLogicalProcessorInformation | 获取逻辑处理器 |
| InjectHook | GetNativeSystemInfo | 获取系统信息 |
| InjectHook | RtlGetNtProductType | 获取系统产品版本（未公开） |
| InjectHook | RtlGetVersion | 获取系统版本 |
| InjectHook | GetProcAddress | 获取函数地址 |
| InjectHook | GetUserNameExW | 获取本机用户名 |
| InjectHook | ConvertSidToStringSidW | Sid转换为字符串 |
| InjectHook | ConvertStringSidToSidW | 字符串转换为Sid |
| InjectHook | FindFirstUrlCacheEntryW | 枚举浏览器缓存 |
| InjectHook | AttachThreadInput | 附加线程输入 |
| InjectHook | GetAsyncKeyState | 获取物理按键状态 |
| InjectHook | GetClipboardData | 获取剪切板数据 |
| InjectHook | GetKeyboardState | 获取键盘虚拟状态 |
| InjectHook | GetRawInputData | 获取原始输入数据 |
| InjectHook | RegisterHotKey | 注册热键 |
| InjectHook | SetWindowsHookEx | 设置消息钩子Ex |
| InjectHook | SetWinEventHook | 设置消息钩子 |
| InjectHook | GetDC | 获取显示设备 |
| InjectHook | BitBlt | 位块传输 |
| InjectHook | CreateCompatibleBitmap | 创建兼容位图 |
| InjectHook | NtUserFindWindowEx | 查找窗口（NTAPI） |
| InjectHook | GetWindowLongPtr | 获取指定窗口信息 |
| InjectHook | CreateService | 创建服务 |
| InjectHook | StartService | 启动服务 |
| InjectHook | ModifyService | 修改服务 |
| InjectHook | DeleteService | 删除服务 |
| InjectHook | StopService | 停止服务 |
| InjectHook | ReadConsoleW | Cmd命令执行 |
| InjectHook | ClearEventLogW | 清除事件日志 |
| InjectHook | DeregisterEventSource | 关闭事件日志写入 |
| InjectHook | CheckRemoteDebuggerPresent | 检查远程调试状态 |
| InjectHook | IsDebuggerPresent | 检查调试状态 |
| InjectHook | CryptAcquireContextW | 获取密钥容器句柄 |
| InjectHook | CryptDeriveKey | 创建加密密钥 |
| InjectHook | CryptUnprotectData | 解密敏感数据 |
| InjectHook | EncryptFileW | 加密文件 |
| InjectHook | CreateRemoteThread | 创建远程线程 |
| InjectHook | QueueUserAPC | APC注入 |
| InjectHook | NtQueueApcThreadEx | APC注入（NTDLL） |
| InjectHook | ReadProcessMemory | 读进程内存 |
| InjectHook | VirtualProtectEx | 修改进程内存保护 |
| InjectHook | VirtualAllocEx | 分配进程内存 |
| InjectHook | WriteProcessMemory | 写进程内存 |
| InjectHook | UuidFromStringW | 转换UUID |
| InjectHook | NtProtectVirtualMemory | 修改虚拟内存保护（NTDLL） |
| InjectHook | NtUnmapViewOfSection | 卸载映射视图（NTDLL） |
| InjectHook | NtOpenProcess | 打开进程（NTDLL） |
| InjectHook | NtWriteVirtualMemory | 写虚拟内存（NTDLL） |
| InjectHook | NtCreateThreadEx | 创建线程（NTDLL） |
| InjectHook | NtMapViewOfSection | 映射内存视图（NTDLL） |
| InjectHook | RtlCreateUserThread | 创建用户线程（NTDLL） |
| InjectHook | SetThreadContext | 设置线程上下文 |
| InjectHook | NtQueryInformationProcess | 获取指定进程信息 |
| InjectHook | AdjustTokenPrivileges | 调整令牌特权 |
| InjectHook | DuplicateTokenEx | 复制令牌 |
| InjectHook | ImpersonateLoggedOnUser | 线程模拟登录用户 |
| InjectHook | LookupPrivilegeValueW | 查询特权LUID |
| InjectHook | CredBackupCredentials | 备份账户凭据 |
| InjectHook | CredEnumerateW | 枚举账户凭据 |
| InjectHook | CredReadW | 读取账户凭据 |
| LeftMove | RemoteAt | 远程计划任务（AT） |
| LeftMove | RemoteDeleteService | 远程删除服务 |
| LeftMove | RemoteModifyService | 远程修改服务 |
| LeftMove | RemoteStartService | 远程启动服务 |
| LeftMove | RemoteCreateService | 远程创建服务 |
| LeftMove | RemoteSheduleTask | 远程计划任务 |
| LeftMove | RemoteStopService | 远程停止服务 |
| LeftMove | RemoteWinRM | 远程WinRM访问 |
| LeftMove | FileWriteShareDir | 修改共享文件 |
| LeftMove | RemotePrint | 远程打印机漏洞 |
| LeftMove | RemoteDCOM-WMI | 远程执行WMI/DCOM |
| LeftMove | RemoteRegQueryValue | 远程注册表查询值 |
| LeftMove | RemoteRegSetValue | 远程注册表修改值 |
| LeftMove | RemoteRegCreateValue | 远程注册表创建值 |
| LeftMove | RemoteRegRenameKey | 远程注册表修改键 |
| LeftMove | RemoteRegDeleteKey | 远程注册表删除键 |
| LeftMove | RemoteRegCreateKey | 远程注册表创建键 |
| Module | LoadDriver | 加载驱动 |
| Module | LoadDll | 加载DLL |
| Network | SocketRequest | Socket请求 |
| Network | NetBind | 网络监听 |
| Network | VulAttack | 漏洞攻击 |
| Network | KerberosRequest | Kerberos请求 |
| Network | NetPing | Ping请求 |
| Network | HttpsRequest | Https请求 |
| Network | HttpRequest | Http请求 |
| Network | NetDnsQuery | DNS查询 |
| Phishing | PhishingNet | 钓鱼外联 |
| Proc | ProcessCreate | 进程创建 |
| Proc | RemoteThread | 远程线程注入 |
| Proc | ProcessHandleObject | 打开进程句柄 |
| Ransomware | DocTrap | 修改诱饵文件 |
| Reg | RegDeleteValue | 注册表删除值 |
| Reg | RegSetValue | 注册表设置值 |
| Reg | RegRenameKey | 注册表重命名键 |
| Reg | RegDeleteKey | 注册表删除键 |
| Reg | RegCreateKey | 注册表创建键 |
| Reg | RegQueryValue | 注册表读取值 |
| Script | ScriptScan | 脚本执行 |
| Script | DocumentOpen | 打开文档 |
| Script | MailOpen | 打开邮件 |
| WinEventLog | SchedTaskCreate | 创建计划任务 |
| WinEventLog | BackupDPMasterKey | 备份数据保护主密钥 |
| WinEventLog | PrivilegedOperation | 执行特权对象 |
| WinEventLog | PrivilegedCall | 调用特权服务 |
| WinEventLog | LogonAssignPrivilege | 新登录分配特权 |
| WinEventLog | ObjectPrivilegeChange | 更改对象权限 |
| WinEventLog | OpenSAMObject | 打开SAM对象句柄 |
| WinEventLog | LoginExplicitCredentials | 显式凭据登录 |
| WinEventLog | LoginClaimsInfo | 登录用户声明 |
| WinEventLog | LoginFailed | 登录失败 |
| WinEventLog | UserLocalGroupEnum | 用户本地组成员枚举 |
| WinEventLog | SystemTimeChange | 系统时间已更改 |
| WinEventLog | WmiCreateProcess | WMI创建进程 |
| WinEventLog | WmiOperation | WMI操作 |
| WinEventLog | AuditLogClear | 安全日志清除记录 |
| WinEventLog | LogShutdown | 事件日志记录服务已关闭 |
| WinEventLog | UserRightAssign | 用户权限分配 |
| WinEventLog | SACLPolicyChange | SACL审核策略更改 |
| WinEventLog | AccountCreate | 用户账户创建 |
| WinEventLog | AccountPwdChange | 用户密码更改 |
| WinEventLog | AccountPwdReset | 用户密码重置 |
| WinEventLog | LoginSuccess | 登录成功 |
| WinEventLog | RegisterSecurityEvent | 注册新的安全事件源 |
| WinEventLog | FirewallSettingChange | 更改 Windows 防火墙本地设置 |
| WinEventLog | SpGroupAssignLogon | 已将特殊组分配给新登录 |
| WinEventLog | NetShareObjAccess | 访问网络共享对象 |
| WinEventLog | NetShareObjAdd | 添加网络共享对象 |
| WinEventLog | NetShareObjModify | 修改网络共享对象 |
| WinEventLog | NetShareObjCheck | 检查网络共享对象的权限 |
| WinEventLog | SMBCheckSpnFail | SMB SPN 检查失败 |
| WinEventLog | CMCredentialBackup | 用户成功备份凭据管理器 |
| WinEventLog | ExtDeviceRecognized | 识别新的外部设备 |
| WinEventLog | UserTokenAdjust | 调整了用户权限 |
| WinEventLog | SchedTaskUpdate | 更新计划任务 |
| WinEventLog | SchedTaskDelete | 删除计划任务 |

#### 示例

```json
{
    "_type": "Event_7520",
    "recvTime": "2023-12-18T23:25:36+08:00",
    "sender": {
        "_type": "Terminal",
        "mid": "0000000000000000000000000000000000000000",
        "publicIP": "192.168.1.1",
        "clientVersion": "108.3.18764.64011",
        "client": {
            "IpPort": "192.168.1.1",
            "Mid": "0000000000000000000000000000000000000000",
            "Guid": "00000000000000000000000000000000",
            "Mac": "C8:5A:CF:00:E8:14",
            "Name": "testing-PC3",
            "User": "testing",
            "OSType": 0,
            "OS": "Microsoft Windows 10 专业版",
            "GroupIDPath": "1.2",
            "GroupNamePath": "全网终端.未分组终端",
            "Account": "",
            "Version": 30399311599434251,
            "GroupId": 2,
            "GroupName": "未分组终端",
            "AccountGroupId": 0,
            "AccountName": "",
            "AccountGroupName": "",
            "AccountGroupIdPath": "",
            "AccountGroupNamePath": "",
            "AccountVirtualGroupId": 0,
            "AccountVirtualGroupName": ""
        },
        "src": null
    },
    "args": {
        "Data": {
            "Action": {
                "KernelName": "NetFlowData",
                "Name": "HttpRequest",
                "Type": "Network"
            },
            "Alert": {},
            "Child": {
                "Direct": 1,
                "DstIp": "58.222.30.69",
                "DstPort": 80,
                "FlowTags": "HttpGet",
                "Host": "archive.kylinos.cn",
                "HostIoc": "WHITE",
                "IpIoc": "UNKNOWN",
                "Protocol": "tcp",
                "SrcIp": "192.168.255.10",
                "SrcPort": 52134,
                "Type": "Network",
                "Url": "http://tencent.com"
            },
            "Common": {
                "AuthId": 28779,
                "ClientVer": "108.3.18764.64011",
                "DeviceGroup": "全网终端.未分组终端",
                "EventId": 67799712,
                "EventTime": 1702913126832,
                "EventUUId": "a4278f52-78db-4270-876a-142fc62ce437",
                "Guid": "00000000000000000000000000000000",
                "KernelId": 86682097,
                "LoginStatus": 2,
                "Mid": "00000000000000000000000000000000",
                "MonitorName": "网络请求",
                "ReportId": 217470,
                "SessionId": 158,
                "Source": "KernelMon",
                "Uid": 0,
                "UserName": ""
            },
            "Environment": {
                "DomainName": "TENCENT",
                "ExportIp": "192.168.1.1",
                "HostName": "testing-PC3",
                "MacAddr": "00-00-00-00-00-00",
                "OsBit": "64",
                "OsBuild": 19045,
                "OsProduectDesc": "Windows 10 Enterprise 22H2",
                "OsType": "Windows",
                "OsUserName": "testing",
                "OsVersion": "Win10",
                "SysStartTimes": 1700474927500
            },
            "Parent": {
                "CallStack": "[]",
                "CloudAttr": "Unknown",
                "FileAccessTime": 1670572121,
                "FileCompany": "VMware, Inc.",
                "FileCopyright": "Copyright © 1998-2022 VMware, Inc.",
                "FileCreateTime": 1701829307,
                "FileDesc": "VMware NAT Service",
                "FileDriverType": "Fixed",
                "FileFormat": "EXE",
                "FileIssuer": "DigiCert Assured ID Code Signing CA-1",
                "FileLegalMark": "",
                "FileMd5": "6ee023f00cd791995a88ec3fac5c7dee",
                "FileMd5Type": "FullMd5",
                "FileModifyTime": 1668532542,
                "FileName": "vmnat.exe",
                "FileOriginalName": "vmnat.exe",
                "FilePath": "C:\\windows\\SysWOW64\\vmnat.exe",
                "FileProductName": "VMware Workstation",
                "FileProductVer": "17.0.0 build-20800274",
                "FileSign": "VMware, Inc.",
                "FileSignStatus": "Valid",
                "FileSignWhite": 1,
                "FileSize": 428184,
                "FileTags": "",
                "FileVersion": "17.0.0 build-20800274",
                "ProcArch": "x86",
                "ProcChainGuid": "13564637203494864296,13561953501747873116,13467929752712774668,13400554540571558492,13400554540571295748,13400554540571295744",
                "ProcChainInfo": "",
                "ProcChainTrust": "Trust",
                "ProcCmdline": "C:\\windows\\SysWOW64\\vmnat.exe",
                "ProcDomainName": "NT AUTHORITY",
                "ProcElevationType": 1,
                "ProcGuid": "13636445328657356468",
                "ProcIntegrity": 6,
                "ProcPid": 5812,
                "ProcTrust": "Trust",
                "ProcUserName": "SYSTEM",
                "SolutionId": 0,
                "ThreadId": 5576,
                "Type": "Proc"
            }
        },
        "Version": 1
    }
}
```

### 已安装的软件全量上报

对应日志报表：无

对应命令字：7019

支持版本：7.X/8.X

上报时机：
* Windows：iOA 进程启动时，进行一次上报，后续每隔4小时会再进行上报
* MacOS：iOA 进程启动时，进行一次上报

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 | 备注 |
| --- | --- | --- | --- | --- |
| SoftwareList | json | 软件列表 |  |  |
| Name | string | 名称 |  |  |
| Version | string | 版本 | |  |
| InstallDate | string | 安装日期 | |  |
| Publisher | string | 发布者 | | SAAS 版本 |
| IsPiracy | int | 是否盗版 | | SAAS 版本 |
| PiracyReasons | string | 盗版原因 | | SAAS 版本 |
| PiracyReasonsEn | string | 盗版原因英文 | | SAAS 版本 |

#### 示例

```json
{
    "SoftwareList": [
        {
            "Name": "QQ拼音输入法6.0",
            "Version": "6.0",
            "InstallDate": "20180818",
            "Publisher":"腾讯科技（深圳）有限公司",
            "IsPiracy":1,
            "PiracyReasons":"修改二进制",
            "PiracyReasonsEn":"modify binary"
        },
        {
            "Name": "企业微信1.0",
            "Version": "2.4.991.1303",
            "InstallDate": "20190804",
            "Publisher":"腾讯科技（深圳）有限公司",
            "IsPiracy":1,
            "PiracyReasons":"更改Host文件",
            "PiracyReasonsEn":"modify host file"
        },
        {
            "Name": "企业微信2.0",
            "Version": "2.4.991.1303",
            "InstallDate": "20180804",
            "Publisher":"腾讯科技（深圳）有限公司",
            "IsPiracy":0
        }
    ]
}
```

### 已安装的软件增量上报

对应日志报表：无

对应命令字：7025

支持版本：7.X/8.X

上报时机：
* Windows：若安装的软件发生变化，1小时内会感知，并进行上报
* MacOS：若安装的软件发生变化，1小时内会感知，并进行上报

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 | 备注 |
| --- | --- | --- | --- | --- |
| Added | json | 相比上次上报结果增加的软件列表 |  | |
| Removed | json | 相比上次上报结果减少的软件列表 | | |
| Name | string | 名称 |  | |
| Version | string | 版本 | | |
| InstallDate | string | 安装日期 | | |
| Publisher | string | 发布者 | | SAAS 版本 |
| IsPiracy | int | 是否盗版 | | SAAS 版本 |
| PiracyReasons | string | 盗版原因 | | SAAS 版本 |
| PiracyReasonsEn | string | 盗版原因英文 | | SAAS 版本 |

#### 示例

```json
{
    "Added": 
    [
        {
            "Name": "QQ拼音输入法6.5",
            "Version": "6.5",
            "InstallDate": "20200818",
            "Publisher":"腾讯科技（深圳）有限公司",
            "IsPiracy":1,
            "PiracyReasons":"修改二进制3",
            "PiracyReasonsEn":"modify binary"
        },
        {
            "Name": "QQ拼音输入法7.5",
            "Version": "7.5",
            "InstallDate": "20220818",
            "Publisher":"腾讯科技（深圳）有限公司",
            "IsPiracy":0,
        }
    ],
    "Removed":
    [
        {
            "Name": "企业微信2.0",
            "Version": "2.4.991.1303",
            "InstallDate": "20180804",
            "Publisher":"腾讯科技（深圳）有限公司"
        }
    ]
}
```

### 文件访问控制上报

对应日志报表：终端管控日志->文件管控日志->文件访问与操作

对应命令字：7102

支持版本：6.X/7.X/8.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| time | string | 本次策略监控结果生成的时间 | |
| acces_time | string | 访问时间 | |
| category | string | 上传类型 | |
| create_time | string | 创建时间 | |
| dst_filename | string | 目标文件路径 | |
| dst_vol_type | string | 目标设备类型 | 1: HARDISK<br /> 2: UDISK<br /> 3: CDROM<br /> 4: NETSHARE<br /> 5: HTTP<br /> 6: FTP<br /> |
| filesize | string | 文件大小 | |
| filetfinger | string | 源文件tfinger | |
| md5 | string | 源文件MD5 | |
| modify_time | string | 修改时间 | |
| operation | string | 文件操作类型 | 1: 创建<br /> 2: 复制<br /> 3: 移动<br /> 4: 删除<br /> 5: 重命名<br /> 6: 读取<br /> 7: 写入<br /> |
| process_id | string | 进程ID | |
| process_name | string | 进程名 | |
| process_path | string | 进程全路径 | |
| src_filename | string | 源文件路径 | |
| src_vol_type | string | 源设备类型 | 1: HARDISK<br /> 2: UDISK<br /> 3: CDROM<br /> 4: NETSHARE<br /> 5: HTTP<br /> 6: FTP<br /> |

#### 示例

```json
{
    "time": "2023-02-20 11:13:28",
    "acces_time": "2023-02-20 11:13:28",
    "category": "fileoperation",
    "create_time": "2021-01-12 15:54:07",
    "dst_filename": "/dest/file",
    "dst_vol_type": "2",
    "filesize": "150168",
    "filetfinger": "1034",
    "md5": "7F90F66F0B48F8ACBB9E486CC8CE02B9",
    "modify_time": "2023-02-20 11:12:45",
    "operation": "4",
    "process_id": "2516",
    "process_name": "Explorer.exe",
    "process_path": "C:\windows\Explorer.exe",
    "src_filename": "F:\iOA_Enterprise_dev\7.2\client\ftcommon\Projects\FTCommonBuild.sln",
    "src_vol_type": "2"
}
```

### 打印审计上报

对应日志报表：终端管控日志->文件管控日志->打印审计

对应命令字：7103

支持版本：6.X/7.X/8.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| UtcTime | string | 本次策略监控结果生成的时间 | |
| category | string | 上传类型 | |
| docname | string | 打印文件路径，可能为“未知” | |
| fid | string | 上传文件标识 | |
| fidscreen | string | 上传截屏文件标识 | |
| module | string | | |
| orientation | string | 纸张方向，1：纵向；2：横向 | |
| papertype | string | 纸张类型 | |
| printerip | string | 打印机IP | |
| printername | string | 打印机名称 | |
| printtotalpages | string | 打印页数 | |
| filesize | string | 文件大小 | |
| uploadstatus | string | 是否上传了文件 | |

#### 示例

```json
{
    "category": "printaudit",
    "UtcTime": "2020-04-24 10:47:40",
    "docname": "C:\\Users\\v_gatingao\\Desktop\\XXX.docx",
    "fid": "2B4072EDFA348E854F48A4F1FABF247A",
    "fidscreen": "XXXXXX",
    "module": "printaudit_info",
    "orientation": "1",
    "papertype": "A4",
    "printerip": "10.80.25.75 172.28.32.1 172.28.48.1 172.31.16.1 172.22.160.1 172.21.112.1 172.17.48.1 ",
    "printername": "Microsoft Print to PDF",
    "printtotalpages": "1",
    "filesize": "111",
    "uploadstatus": "1"
}
```

### 剪贴板审计上报

对应日志报表：终端管控日志->文件管控日志->进程截屏审计

对应命令字：7108

支持版本：6.X/7.X/8.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| UtcTime | string | 本次策略监控结果生成的时间 | |
| category | string | 上传类别，此处为Clipboard | |
| docname | string | 打印文件路径，可能为“未知” | |
| fid | string | 上传文件标识 | |
| fidscreen | string | 上传截屏文件标识 | |
| processname | string | 进程名 | |
| processpath | string | 进程全路径 | |
| filesize | string | 文件大小 | |
| uploadstatus | string | 是否上传了文件 | |

#### 示例

```json
{
    "category": "clipboard",
    "UtcTime": "2020-04-24 10:47:40",
    "fid": "2E86A4D4A6332F8990068803DB6D9153",
    "fidscreen": "XXXXXXXX",
    "processname": "WXWORK.EXE",
    "processpath": "C:\\PROGRAM FILES (X86)\\WXWORK\\WXWORK.EXE",
    "filesize": "111",
    "uploadstatus": "1"
}
```

### 软件分发日志

对应日志报表：客户端操作日志->软件分发日志

对应命令字：7204

支持版本：7.X/8.X/SAAS

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Time | int | 时间 | |
| MachineName | string | 终端名称 | |
| SoftwareName | string | 软件名称 | |
| Type | int | 类型 | 1: 文件<br /> 2: 脚本<br /> 3: 二进制（软件）<br /> 4: 卸载<br /> 5: 壁纸切换<br /> 6: 补丁<br /> |
| Comment | string | 备注 | |
| Status | string | 分发状态 | |
| InstallStatus | string | 安装状态 | |

#### 示例

```json
{
    "Time": 1452312312,
    "MachineName": "abc",
    "SoftwareName": "abc",
    "Type": 1,
    "Comment": "xxx",
    "Status": "分发成功",
    "InstallStatus": "安装成功"
}
```

### 活跃用户上报

对应日志报表：无

对应命令字：7245

支持版本：8.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| UID | int | UID | |
| ReportTime | int | 上报时间 | |

#### 示例

```json
{
    "UID": 123,
    "ReportTime": 1688540428
}
```

### License授权日志

对应日志报表：License授权日志->License授权日志

对应命令字：7252

支持版本：8.2+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| Mid | string | Mid | |
| AuthType | string | 授权类型 | |
| AuthMode | string | 授权方式 | |
| Reason | string | 原因 | |
| AuthTime | string | 授权时间 | |
| Modules | other | 授权功能 | |

#### 示例

```json
{
    "Mid": "abc",
    "AuthType": "授权激活",
    "AuthMode": "手动回收",
    "Reason": "原因",
    "AuthTime": "2023-09-22 15:01:02",
    "Modules": [{"ModuleKey": "NGN", "ModuleName": "无边界办公"}]
}
```

### 终端自定义分组自动划分日志

对应日志报表：终端运维日志->终端自定义分组自动划分日志

对应命令字：7260

支持版本：7.5+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| OriginGroups | string | 原分组 | |
| TargetGroups | string | 目标分组 | |
| RuleCode | string | 添加规则 | |
| RuleType | string | 时间设置 | |
| Timestamp | int | 移动时间 | |

#### 示例

```json
{
    "OriginGroups": "Group A",
    "TargetGroups": "Group B",
    "RuleCode": "xxxxx",
    "RuleType": "每小时执行一次",
    "Timestamp": 1618382918
}
```

### 终端字段登记日志

对应日志报表：系终端运维日志->终端字段登记日志

对应命令字：7261

支持版本：7.5+

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| LabelField | string | 标签字段 | |
| MatchField | string | 匹配字段 | |
| MatchValue | string | 源数据 | |
| TagValue | string | 结果数据 | |
| RuleType | string | 规则类型 | |
| Result | string | 对接结果 | |
| Timestamp | int | 终端标记时间 | |

#### 示例

```json
{
    "LabelField": "XXX",
    "MatchField": "YYY",
    "MatchValue": "ZZZ",
    "TagValue": "AAA",
    "RuleType": "Rule A",
    "Result": "成功",
    "Timestamp": 1618382918
}
```

### IAM登出日志上报

对应日志报表：身份安全日志->用户登录日志

对应命令字：7725

支持版本：7.1/8.3

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| UID | int | 用户表唯一UID | |
| Step | string | 动作 | |
| ActionInformation | string | 登出详情 | |
| ErrorCode | string | 错误码 | success: 成功<br /> failure: 失败<br /> |
| ErrorMsg | string | 错误信息 | 登出: 登出<br /> |
| Timestamp | int | 上报时间戳 | |

#### 示例

```json
{
    "UID": 8,
    "Step": "logout",
    "ActionInformation": "logout detail",
    "ErrorCode": "success",
    "ErrorMsg": "成功",
    "Timestamp": 1654745421
}
```

### 远程桌面使用日志上报

对应日志报表：客户端操作日志->远程桌面使用日志

对应命令字：7755

支持版本：8.1

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| LocalMid | string | 本地机器的Mid | |
| RemoteMid | string | 远程机器的Mid | |
| UId | string | UId | |
| Status | int | Status | 0: 开始远程<br /> 1: 断开远程<br /> |
| Timestamp | int | 时间 | |

#### 示例

```json
{
    "LocalMid": "AD3D6C2D37C3743528048D47C385C61164E825EF",
    "RemoteMid": "1CAAA818C41667C5C86013D71768B79F64E739BE",
    "UId": "3670",
    "Status": 0,
    "Timestamp": 1654745421
}
```

### 进程触碰文件审计

对应日志报表：终端管控日志->文件管控日志->进程触碰文件审计

对应命令字：7509

支持版本：6.X/7.X/8.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| filesendtime | string | 文件发送时间 | |
| filepath | string | 文件路径 | |
| procname | string | 进程名 | |
| fid | string | 源文件id | |
| fidscreen | string | 截屏文件md5 | |

#### 示例

```json
{
    "filesendtime": "2023-02-20 11:13:28",
    "filepath": "c:\\test\\666.txt",
    "procname": "c:\\process\\666.exe",
    "fid": "3b1b2f32312",
    "fidscreen": "XXXXXXX"
}
```

### License账号授权日志

对应日志报表：License授权日志->License账号授权日志

对应命令字：7257

支持版本：8.2

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| AccountId | int | 用户id | |
| AuthTime | string | 授权时间 | |
| LoginTime | string | 登录时间 | |
| AuthType | string | 授权类型 | |
| AuthMode | string | 授权方式 | |
| Reason | string | 原因 | |
| Modules | other | 授权功能 | |

#### 示例

```json
{
    "AccountId": 1,
    "AuthTime": "2023-09-22 15:01:02",
    "LoginTime": "2023-09-22 15:01:02",
    "AuthType": "授权激活",
    "AuthMode": "手动回收",
    "Reason": "原因",
    "Modules": [{"ModuleKey": "NGN", "ModuleName": "无边界办公"}]
}
```

### SSL卸载日志上报

对应日志报表：资源访问日志->代理访问日志

对应命令字：7234

支持版本：8.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| requestBytes | string | requestBytes | |
| targetPort | string | targetPort | |
| duration | string | duration | |
| authorization | string | authorization | |
| datestamp | string | datestamp | |
| remoteAddress | string | remoteAddress | |
| targetHost | string | targetHost | |
| localPort | string | localPort | |
| remotePort | string | remotePort | |
| remoteFamily | string | remoteFamily | |
| target | string | target | |
| responseBytes | string | responseBytes | |
| forwardedFor | string | forwardedFor | |
| localAddress | string | localAddress | |
| sourceName | string | sourceName | |

#### 示例

```json
{
    "requestBytes": "5927",
    "targetPort": "443",
    "duration": "85552",
    "authorization": "Basic XXX",
    "datestamp": "2023-06-21 09:43:56.854",
    "remoteAddress": "10.81.232.20",
    "targetHost": "14.119.104.189",
    "localPort": "13052",
    "remotePort": "63446",
    "remoteFamily": "IPv4",
    "target": "sp1.baidu.com:443",
    "responseBytes": "3186",
    "forwardedFor": "10.81.232.20",
    "localAddress": "9.134.5.116",
    "sourceName": "tcp"
}
```

### VPN网关日志上报

对应日志报表：资源访问日志->隧道转发日志

对应命令字：7371

支持版本：8.X

#### 格式

| 字段名       | 字段类型                | 字段说明             |
|--------------|-----------------------|----------------------|
| protocol     | string                | 传输协议             |
| src_ip       | string                | 源IP地址             |
| src_port     | int                   | 源端口               |
| dst_ip       | string                | 目的IP地址           |
| dst_port     | int                   | 目的端口             |
| trace_id     | string                | 跟踪ID               |
| UserName     | string                | 用户名               |
| DeviceID     | string                | 设备ID               |
| ST           | string                | 安全令牌             |
| AppID        | int                   | 应用ID               |
| AppName      | string                | 应用名称             |
| AppVersion   | string                | 应用版本             |
| ReqUrl       | string                | 请求URL              |
| ProcName     | string                | 进程名称             |
| Source       | string                | 数据源               |
| PID          | int                   | 进程ID               |
| ServiceId    | string                | 服务ID               |
| TenantId     | string                | 租户ID               |
| RetCode      | int                   | 返回码               |
| RecordTime   | string     | 记录时间             |
| server_ip    | string                | 服务器IP地址          |
| RetMsg       | string                | 返回消息             |
| ClientIp     | string                | 客户端IP地址          |

#### 示例

```json
{
    "protocol":"UDP",
    "src_ip":"10.0.2.5",
    "src_port":49290,
    "dst_ip":"10.1.214.223",
    "dst_port":18443,
    "trace_id":"de7c1036776c3b744d8efd5c4824c3baa6cd1870f61e8dd445d3b366a3ae10c1",
    "UserName":"xxx",
    "DeviceID":"0F375338DFD1F630761A129C2A2F40F063AB49B502",
    "ST":"XXX",
    "AppID":"0",
    "AppName":"smartVPN",
    "AppVersion":"10.1.1.4",
    "ReqUrl":"10.1.214.223:18443",
    "ProcName":"plow_ipaddr",
    "Source":"",
    "PID":0,
    "ServiceId":"",
    "TenantId":"",
    "RetCode":0,
    "RecordTime":"2023-02-10 15:36:42.023",
    "server_ip": "1.2.3.4",
    "RetMsg": "",
    "ClientIp": "2.3.4.5"
}
```

### UEBA风险分析日志上报

对应日志报表：风险分析日志

对应命令字：7246

支持版本：8.X

#### 格式

| 字段名                | 字段类型       | 字段说明                                       |
|----------------------|------------|--------------------------------------------|
| Event                | string     | 固定值-UserBehaviorRisk                    |
| EventType            | string     | 事件类型(ueba_event_login, ueba_event_access, ueba_event_user) |
| RiskLevel            | string     | 风险等级 (low, middle, high)              |
| TenantID             | string     | 租户ID                                     |
| Location             | string     | 本次位置                                   |
| IP                   | string     | 本次IP                                     |
| DeviceID             | string     | 设备ID                                     |
| AccountID            | int      | account_id(int，对应accounts表主键)        |
| Timestamp            | int      | 触发时间戳                                 |
| CommonLocations      | []string   | 常用位置                                   |
| CommonIPs            | []string   | 常用IP                                     |
| CommonDevices        | []string   | 常用设备ID                                 |
| NonWorkingHours      | []string   | 这个企业的非工作时间 [00:00,06:00]        |
| FailedLoginCount     | int      | 登录失败次数                               |
| FailedLoginTimestamps| [2]int  | 登录日志(登录失败)的时间戳区间              |
| SensitiveAccessStats | struct     |                                             |
| - Duration           | int64      | 敏感业务时长统计(秒)                      |
| - Timestamps         | [2]int   | 敏感业务时间，访问日志的时间戳区间         |
| - ResourceIDs        | []int    | 敏感资源的ID组                             |
| UnauthorizedAccessCount | int | 访问无权业务次数                            |
| UnauthorizedAccessTimestamps | [2]int | 访问无权业务的时间戳区间                    |
| HighDownloadTraffic  | struct     |                                             |
| - TotalTraffic       | int      | 下载总流量                                 |
| - Timestamps         | [2]int   | 访问日志的时间戳区间                       |
| HighUploadTraffic   | struct     |                                             |
| - TotalTraffic       | int      | 上传总流量                                 |
| - Timestamps         | [2]int   | 访问日志的时间戳区间                       |
| StrategyID          | int      | 策略ID(对应ueba_strategies表主键)        |
| IsRemoteLogin       | bool       | SaaS 告警需要新增                         |
| IsUncommonDevice    | bool       | SaaS 告警需要新增                         |

#### 示例

```json
{
  "event": "UserBehaviorRisk",
  "event_type": "ueba_event_login",
  "risk_level": "high",
  "tenant_id": "123456",
  "location": "上海",
  "ip": "192.168.1.1",
  "device_id": "ws9774dsd56d682e54912s11",
  "account_id": 789,
  "timestamp": 1652419200,
  "common_locations": [
    "上海",
    "北京"
  ],
  "common_ips": [
    "192.168.1.1",
    "192.168.1.2"
  ],
  "common_devices": [
    "ws9774dsd56d682e54912s11",
    "sd977sds4d56d682e5491111"
  ],
  "non_working_hours": [
    "00:00",
    "06:00"
  ],
  "failed_login_count": 3,
  "failed_login_timestamps": [
    1652332800,
    1652419200
  ],
  "sensitive_access_stats": {
    "duration": 121212,
    "timestamps": [
      1652332800,
      1652419200
    ],
    "resource_ids": [
      1,
      2
    ]
  },
  "unauthorized_access_count": 2,
  "unauthorized_access_timestamps": [
    1652332800,
    1652419200
  ],
  "high_download_traffic": {
    "total_traffic": 1024,
    "timestamps": [
      1652332800,
      1652419200
    ]
  },
  "high_upload_traffic": {
    "total_traffic": 2048,
    "timestamps": [
      1652332800,
      1652419200
    ]
  },
  "strategy_id": 456
}
```


### 管理员日志上报

对应日志报表：管理员日志

对应命令字：7210

支持版本：7.X/8.X

#### 格式

| 字段名 | 字段类型 | 字段说明 | 取值说明 |
| --- | --- | --- | --- |
| request.headers | json | 请求头 | |
| request.method | string | 请求类型 | POST, GET |
| request.querystring | json | 请求参数 | |
| request.size | int | 大小 | |
| request.uri | int | 请求uri | |
| request.url | int | 请求url | |
| response | json | 返回内容 | |

#### 示例

```json
{
    "request" : {
        "headers" : {
            "content-type" : "application/json",
            "cookie": "xxx"
        },
        "method" : "POST",
        "querystring" : { },
        "size" : 3539,
        "uri" : "/capi/License/DescribeCurrentLicense",
        "url" : "http://main-a.ioa.woa.com:8010/capi/License/DescribeCurrentLicense"
    },
    "response": {
        "message": "ok"
    }
}
```

注意：控制台管理员登录登出日志根据 7210 上报过滤得到，其中
- 管理员登录：request.uri = '/api/napi/AppUserLogin/user/login'
- 管理员登出：request.uri = '/api/napi/AppUserLogin/user/logout'
