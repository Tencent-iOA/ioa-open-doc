## 1. 接口描述

<strong><font color="blue">此接口被设置为 产品内部展示 。</font></strong>

<strong><font color="blue">此文档展示的是开发联调环境的接口文档 。</font></strong>

接口请求域名： ioa.tencentcloudapi.com 。

用户自定义字段数据推送接口，私有化调用path为：/capi/Assets/Device/CreateCustomFields；

功能描述： 同IOA客户端配合使用，通过该接口输入数据流，创建满足条件的自定义字段，然后根据配置的周期定期执行 客户端上报字段 和 输入数据流的匹配处理，并根据匹配结果对前面创建的自定义字段做相应的赋值；

使用场景： 通过该接口批量对接企业内部数据 和 IOA系统数据，用创建自定义字段的形式，对满足接口配置的条件的数据进行打标处理； 场景举例：企业资产对接需求，通过该接口批量上传企业资产库数据，来和IOA客户端上报的对应资产字段做匹配处理，当上报字段存在于企业资产库中，则标记该设备为内部资产设备，否则标记为非内部资产；

参数功能介绍： Schema： 定义字段对应关系和配置关系，其中 DeviceCustomField：自定义字段字段名（打标字段）； DeviceMatchField：接入第三方字段名称（匹配字段）； RuleType：（匹配规则：1：匹配固定值，置为指定值；2：匹配列表数据是否存在，置为指定值；3：匹配值和指定值一一对应）； DefaultValue：匹配不成功的默认值； Datas：输入数据流数据结构，其中DeviceMatchField和Schema中的DeviceMatchField一一对应，Schema中定义了多少个DeviceMatchField和DeviceCustomField的关系，Datas中需有对应多少个DeviceMatchField的数据源数据； MatchItems：是用于匹配的数据结构，其中Match：用于匹配的数据，SetValue：匹配成功设置的值；

## 2. 输入参数

以下请求参数列表仅列出了接口请求参数和部分公共参数，完整公共参数列表见 [公共请求参数](/document/product/1679/14881?!preview&preview_docmenu=1&lang=cn&!document=1)。

| 参数名称 | 必选 | 类型 | 描述 |
|---------|---------|---------|---------|
| Action | 是 | String | [公共参数](/document/product/1679/14881?!preview&preview_docmenu=1&lang=cn&!document=1)，本接口取值：CreateCustomFields。 |
| Version | 是 | String | [公共参数](/document/product/1679/14881?!preview&preview_docmenu=1&lang=cn&!document=1)，本接口取值：2022-06-01。 |
| Region | 否 | String | [公共参数](/document/product/1679/14881?!preview&preview_docmenu=1&lang=cn&!document=1)，本接口不需要传递此参数。 |
| Schemas.N | 否 | Array of [CreateCustomFieldsReqSchema](/document/product/1679/76684?!preview&preview_docmenu=1&lang=cn&!document=1#CreateCustomFieldsReqSchema) | <strong><font color="blue">此参数仅产品内部展示。</font></strong>定义字段对应关系和配置关系 |
| Datas.N | 否 | Array of [CreateCustomFieldsReqData](/document/product/1679/76684?!preview&preview_docmenu=1&lang=cn&!document=1#CreateCustomFieldsReqData) | <strong><font color="blue">此参数仅产品内部展示。</font></strong>数据部分结构 |

## 3. 输出参数

| 参数名称 | 类型 | 描述 |
|---------|---------|---------|
| RequestId | String | 唯一请求 ID，每次请求都会返回。定位问题时需要提供该次请求的 RequestId。|

## 4. 示例

### 示例1 自定义字段数据推送接口--综合使用

用户通过该接口推送数据，来创建终端自定义字段。本示例表示分别创建四个自定义字段‘dst_key1’、‘dst_key2’、‘dst_key3’、‘dst_key4’。其中‘dst_key1’值的设置规则是根据‘src_key1’字段的值进行设置：当值为‘aa1’时，设置‘dst_key1’的值为 ‘val1_1’，否则设置为‘def1’；同样‘dst_key2’值的设置规则是根据‘src_key2’字段的值进行设置：当值在‘bb1’、‘bb2’、‘bb3’中，设置‘dst_key2’的值为 ‘val2_1’，否则设置为‘def2’；‘dst_key3’值的设置规则是根据‘src_key3’字段的值进行设置：当值为‘cc1’时，设置‘dst_key3’的值为 ‘val3_1’，当值为‘cc2’时设置‘val3_2’，当值为‘cc3’时设置‘val3_3’，否则设置为‘def3’；‘dst_key4’的设置原理同‘dst_key3’，根据‘trusted_device_id’字段的值进行设置，当设备数据中‘trusted_device_id’字段的值为‘1111111’时，该设备的‘dst_key3’字段设置为‘val4_1’；设备数据‘trusted_device_id’字段的值为‘2222222’时，此设备的‘dst_key3’字段设置为‘val4_2’；设备数据‘trusted_device_id’字段的值为‘3333333’时，此设备的‘dst_key3’字段设置为‘val4_3’；其他情况则设备的‘dst_key3’字段设置为‘def4’。

#### 输入示例

```
POST / HTTP/1.1
Host: ioa.tencentcloudapi.com
Content-Type: application/json
X-TC-Action: CreateCustomFields
<公共请求参数>

{
    "Schemas": [
        {
            "DeviceCustomField": "dst_key1",
            "DeviceMatchField": "src_key1",
            "RuleType": 1,
            "DefaultValue": "def1"
        },
        {
            "DeviceCustomField": "dst_key2",
            "DeviceMatchField": "src_key2",
            "RuleType": 2,
            "DefaultValue": "def2"
        },
        {
            "DeviceCustomField": "dst_key3",
            "DeviceMatchField": "src_key3",
            "RuleType": 3,
            "DefaultValue": "def3"
        },
        {
            "DeviceCustomField": "dst_key4",
            "DeviceMatchField": "trusted_device_id",
            "RuleType": 3,
            "DefaultValue": "def4"
        }
    ],
    "Datas": [
        {
            "DeviceMatchField": "src_key1",
            "MatchItems": [
                {
                    "Match": "aa1",
                    "SetValue": "val1_1"
                }
            ]
        },
        {
            "DeviceMatchField": "src_key2",
            "MatchItems": [
                {
                    "Match": "bb1",
                    "SetValue": "val2_1"
                },
                {
                    "Match": "bb2",
                    "SetValue": "val2_1"
                },
                {
                    "Match": "bb3",
                    "SetValue": "val2_1"
                }
            ]
        },
        {
            "DeviceMatchField": "src_key3",
            "MatchItems": [
                {
                    "Match": "cc1",
                    "SetValue": "val3_1"
                },
                {
                    "Match": "cc2",
                    "SetValue": "val3_2"
                },
                {
                    "Match": "cc3",
                    "SetValue": "val3_3"
                }
            ]
        },
        {
            "DeviceMatchField": "trusted_device_id",
            "MatchItems": [
                {
                    "Match": "1111111",
                    "SetValue": "val4_1"
                },
                {
                    "Match": "2222222",
                    "SetValue": "val4_2"
                },
                {
                    "Match": "3333333",
                    "SetValue": "val4_3"
                }
            ]
        }
    ]
}
```

#### 输出示例

```
{
    "Response": {
        "RequestId": "b5cb514d-12fa-41fc-80a5-8670f83ca82b"
    }
}
```

### 示例2 创建自定义字段-匹配固定值，置为指定值（RuleType=1）

用户通过该接口推送数据，创建终端自定义字段。本示例表示创建自定义字段‘dst_key1’；‘dst_key1’值的设置规则是根据‘src_key1’字段的值进行设置：当值为‘aa1’时，设置‘dst_key1’的值为 ‘val1_1’，否则设置为‘def1’；从而对满足特定条件的数据打标指定的值。

#### 输入示例

```
POST / HTTP/1.1
Host: ioa.tencentcloudapi.com
Content-Type: application/json
X-TC-Action: CreateCustomFields
<公共请求参数>

{
	"Schemas": [{
		"DeviceCustomField": "dst_key1",
		"DeviceMatchField": "src_key1",
		"RuleType": 1,
		"DefaultValue": "def1"
	}],
	"Datas": [{
		"DeviceMatchField": "src_key1",
		"MatchItems": [{
			"Match": "aa1",
			"SetValue": "val1_1"
		}]
	}]
}
```

#### 输出示例

```
{
    "Response": {
        "RequestId": "b5cb514d-12fa-41fc-80a5-2340f83ca82f"
    }
}
```

### 示例3 创建自定义字段-匹配列表数据是否存在，置为指定值（RuleType=2）

用户通过该接口推送数据，创建终端自定义字段。本示例表示创建自定义字段‘dst_key2’；‘dst_key2’值的设置规则是根据‘src_key2’字段的值进行设置：当值在‘bb1’、‘bb2’、‘bb3’中，设置‘dst_key2’的值为 ‘val2_1’，否则设置为‘def2’；从而对存在于配置规则中的数据打标指定的值。

#### 输入示例

```
POST / HTTP/1.1
Host: ioa.tencentcloudapi.com
Content-Type: application/json
X-TC-Action: CreateCustomFields
<公共请求参数>

{
	"Schemas": [{
		"DeviceCustomField": "dst_key2",
		"DeviceMatchField": "src_key2",
		"RuleType": 2,
		"DefaultValue": "def2"
	}],
	"Datas": [{
		"DeviceMatchField": "src_key2",
		"MatchItems": [{
				"Match": "bb1",
				"SetValue": "val2_1"
			},
			{
				"Match": "bb2",
				"SetValue": "val2_1"
			},
			{
				"Match": "bb3",
				"SetValue": "val2_1"
			}
		]
	}]
}
```

#### 输出示例

```
{
    "Response": {
        "RequestId": "abc"
    }
}
```

### 示例4 创建自定义字段-匹配值和指定值一一对应（RuleType=3）

用户通过该接口推送数据，创建终端自定义字段。本示例表示创建自定义字段‘dst_key3’；‘dst_key3’值的设置规则是根据‘src_key3’字段的值进行设置：当值为‘cc1’时，设置‘dst_key3’的值为 ‘val3_1’，当值为‘cc2’时设置‘val3_2’，当值为‘cc3’时设置‘val3_3’，否则设置为‘def3’；从而对存在于配置规则中的数据打标对应的值。

#### 输入示例

```
POST / HTTP/1.1
Host: ioa.tencentcloudapi.com
Content-Type: application/json
X-TC-Action: CreateCustomFields
<公共请求参数>

{
	"Schemas": [{
		"DeviceCustomField": "dst_key3",
		"DeviceMatchField": "src_key3",
		"RuleType": 3,
		"DefaultValue": "def3"
	}],
	"Datas": [{
		"DeviceMatchField": "src_key3",
		"MatchItems": [{
			"Match": "cc1",
			"SetValue": "val3_1"
		}, {
			"Match": "cc2",
			"SetValue": "val3_2"
		}, {
			"Match": "cc3",
			"SetValue": "val3_3"
		}]
	}]
}
```

#### 输出示例

```
{
    "Response": {
        "RequestId": "abc"
    }
}
```


## 5. 开发者资源

### 腾讯云 API 平台

[腾讯云 API 平台](https://cloud.tencent.com/api) 是综合 API 文档、错误码、API Explorer 及 SDK 等资源的统一查询平台，方便您从同一入口查询及使用腾讯云提供的所有 API 服务。

### API Inspector

用户可通过 [API Inspector](https://cloud.tencent.com/document/product/1278/49361) 查看控制台每一步操作关联的 API 调用情况，并自动生成各语言版本的 API 代码，也可前往 [API Explorer](https://cloud.tencent.com/document/product/1278/46697) 进行在线调试。

### SDK

云 API 3.0 提供了配套的开发工具集（SDK），支持多种编程语言，能更方便的调用 API。

* [Tencent Cloud SDK 3.0 for Python](https://github.com/TencentCloud/tencentcloud-sdk-python/blob/master/tencentcloud/ioa/v20220601/ioa_client.py)
* [Tencent Cloud SDK 3.0 for Java](https://github.com/TencentCloud/tencentcloud-sdk-java/blob/master/src/main/java/com/tencentcloudapi/ioa/v20220601/IoaClient.java)
* [Tencent Cloud SDK 3.0 for PHP](https://github.com/TencentCloud/tencentcloud-sdk-php/blob/master/src/TencentCloud/Ioa/V20220601/IoaClient.php)
* [Tencent Cloud SDK 3.0 for Go](https://github.com/TencentCloud/tencentcloud-sdk-go/blob/master/tencentcloud/ioa/v20220601/client.go)
* [Tencent Cloud SDK 3.0 for NodeJS](https://github.com/TencentCloud/tencentcloud-sdk-nodejs/blob/master/tencentcloud/services/ioa/v20220601/ioa_client.js)
* [Tencent Cloud SDK 3.0 for .NET](https://github.com/TencentCloud/tencentcloud-sdk-dotnet/blob/master/TencentCloud/Ioa/V20220601/IoaClient.cs)
* [Tencent Cloud SDK 3.0 for C++](https://github.com/TencentCloud/tencentcloud-sdk-cpp/blob/master/ioa/src/v20220601/IoaClient.cpp)
* [Tencent Cloud SDK 3.0 for Ruby](https://github.com/TencentCloud/tencentcloud-sdk-ruby/blob/master/tencentcloud-sdk-ioa/lib/v20220601/client.rb)

### 命令行工具

* [Tencent Cloud CLI 3.0](https://cloud.tencent.com/document/product/440/6176)

## 6. 错误码

以下仅列出了接口业务逻辑相关的错误码，其他错误码详见 [公共错误码](/document/product/1679/44019?!preview&preview_docmenu=1&lang=cn&!document=1#.E5.85.AC.E5.85.B1.E9.94.99.E8.AF.AF.E7.A0.81)。

| 错误码 | 描述 |
|---------|---------|
| InternalError.DatabaseException | 内部错误，数据库异常。 |
| InvalidParameter.DuplicateResourcesExist | 存在重复的资源数据。 |
| InvalidParameter.RequestParam | 请求参数错误。 |
| ResourceNotFound.NoModuleData | 没有模块数据。 |
| ResourceNotFound.NoResourceData | 没有业务资源数据。 |
| UnauthorizedOperation.NoModulePermissions | 没有模块权限。 |
| UnauthorizedOperation.NoResourcePermissionsd | 当前业务资源无权限。 |
